import{g as u,b1 as W,b2 as O,aQ as E,j as e,q as S,aT as D,aV as B,cb as ae,bO as Ce,aZ as U,aS as Q,bk as ie,z as G,bI as H,M as y,I as g,B as x,T as f,D as K,A as Se,L as oe,Z as Le,dZ as Ie,G as C,dv as le,x as ce,E as de,O as pe,ca as ke,dr as xe,b5 as we,e3 as Te,R as Re,e4 as Ae,C as Ne}from"./index-usks_mw-.js";import{E as $e}from"./empty-content-CMvi2U-9.js";import{u as J}from"./use-checkout-context-C2ngSiA6.js";import{f as F}from"./format-number-1JRP8vfz.js";import{S as ee}from"./Stack-CgODRvvD.js";import{T as ze}from"./table-head-custom-rWvUIPuG.js";import{N as Fe}from"./number-input-BI968xy4.js";import{T as De,a as Me,b as Pe}from"./TableHead-DRTkY3AT.js";import{T as P}from"./TableCell-DewNvLwg.js";import{s as We,z as Z}from"./zod-RlOVw4MX.js";import{b as he,C as me,u as ue,F as Oe}from"./styles-CfUPITlh.js";import"./code-highlight-block-BPaUgu3R.js";import"./preview-single-file-BDCIPO5I.js";import{F as Ee}from"./form-provider-BBryKxXX.js";import{P as Be}from"./payment-new-card-form-BrTBKxOh.js";import{D as Ue}from"./DialogTitle-B2IaybZq.js";import{D as Ge}from"./DialogContent-hfRIofTz.js";import{D as He}from"./DialogActions-tMlZhSgp.js";import{A as Ve}from"./address-item-C-tjar81.js";import{A as _e}from"./address-new-form-_g4bz3B1.js";import"./Checkbox-CXJQ1e9t.js";import"./fields-C0p86-nh.js";import"./Rating-D7Aom_ED.js";import"./editor-Dgj6bP_R.js";import"./FormGroup-BcIuZYAH.js";import"./FormControlLabel-4BKoF0oU.js";import"./index-BZxbeKDV.js";import"./index-Chjiymov.js";import"./upload-D-BZQNpO.js";import"./index-D7BwrrXM.js";import"./image-CI7Up_jg.js";import"./DatePicker-bZIT4znD.js";import"./dialogTitleClasses-ArRuUPNv.js";import"./schema-helper-nSaw4j_a.js";const q=u.createContext({}),te=u.createContext({});function Je(t){return W("MuiStep",t)}O("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const qe=t=>{const{classes:n,orientation:r,alternativeLabel:s,completed:o}=t;return B({root:["root",r,s&&"alternativeLabel",o&&"completed"]},Je,n)},Qe=S("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:r}=t;return[n.root,n[r.orientation],r.alternativeLabel&&n.alternativeLabel,r.completed&&n.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Ze=u.forwardRef(function(n,r){const s=E({props:n,name:"MuiStep"}),{active:o,children:a,className:l,component:i="div",completed:c,disabled:h,expanded:d=!1,index:p,last:m,...b}=s,{activeStep:j,connector:v,alternativeLabel:k,orientation:R,nonLinear:L}=u.useContext(q);let[I=!1,N=!1,A=!1]=[o,c,h];j===p?I=o!==void 0?o:!0:!L&&j>p?N=c!==void 0?c:!0:!L&&j<p&&(A=h!==void 0?h:!0);const M=u.useMemo(()=>({index:p,last:m,expanded:d,icon:p+1,active:I,completed:N,disabled:A}),[p,m,d,I,N,A]),w={...s,active:I,orientation:R,alternativeLabel:k,completed:N,disabled:A,expanded:d,component:i},$=qe(w),z=e.jsxs(Qe,{as:i,className:D($.root,l),ref:r,ownerState:w,...b,children:[v&&k&&p!==0?v:null,a]});return e.jsx(te.Provider,{value:M,children:v&&!k&&p!==0?e.jsxs(u.Fragment,{children:[v,z]}):z})}),Ye=ae(e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),Xe=ae(e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Ke(t){return W("MuiStepIcon",t)}const Y=O("MuiStepIcon",["root","active","completed","error","text"]);var se;const et=t=>{const{classes:n,active:r,completed:s,error:o}=t;return B({root:["root",r&&"active",s&&"completed",o&&"error"],text:["text"]},Ke,n)},X=S(Ce,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,n)=>n.root})(U(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${Y.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${Y.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${Y.error}`]:{color:(t.vars||t).palette.error.main}}))),tt=S("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,n)=>n.text})(U(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}))),nt=u.forwardRef(function(n,r){const s=E({props:n,name:"MuiStepIcon"}),{active:o=!1,className:a,completed:l=!1,error:i=!1,icon:c,...h}=s,d={...s,active:o,completed:l,error:i},p=et(d);if(typeof c=="number"||typeof c=="string"){const m=D(a,p.root);return i?e.jsx(X,{as:Xe,className:m,ref:r,ownerState:d,...h}):l?e.jsx(X,{as:Ye,className:m,ref:r,ownerState:d,...h}):e.jsxs(X,{className:m,ref:r,ownerState:d,...h,children:[se||(se=e.jsx("circle",{cx:"12",cy:"12",r:"12"})),e.jsx(tt,{className:p.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:d,children:c})]})}return c});function rt(t){return W("MuiStepLabel",t)}const T=O("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),ot=t=>{const{classes:n,orientation:r,active:s,completed:o,error:a,disabled:l,alternativeLabel:i}=t;return B({root:["root",r,a&&"error",l&&"disabled",i&&"alternativeLabel"],label:["label",s&&"active",o&&"completed",a&&"error",l&&"disabled",i&&"alternativeLabel"],iconContainer:["iconContainer",s&&"active",o&&"completed",a&&"error",l&&"disabled",i&&"alternativeLabel"],labelContainer:["labelContainer",i&&"alternativeLabel"]},rt,n)},st=S("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:r}=t;return[n.root,n[r.orientation]]}})({display:"flex",alignItems:"center",[`&.${T.alternativeLabel}`]:{flexDirection:"column"},[`&.${T.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),at=S("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,n)=>n.label})(U(({theme:t})=>({...t.typography.body2,display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${T.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${T.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${T.alternativeLabel}`]:{marginTop:16},[`&.${T.error}`]:{color:(t.vars||t).palette.error.main}}))),it=S("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,n)=>n.iconContainer})({flexShrink:0,display:"flex",paddingRight:8,[`&.${T.alternativeLabel}`]:{paddingRight:0}}),lt=S("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,n)=>n.labelContainer})(U(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${T.alternativeLabel}`]:{textAlign:"center"}}))),be=u.forwardRef(function(n,r){const s=E({props:n,name:"MuiStepLabel"}),{children:o,className:a,componentsProps:l={},error:i=!1,icon:c,optional:h,slots:d={},slotProps:p={},StepIconComponent:m,StepIconProps:b,...j}=s,{alternativeLabel:v,orientation:k}=u.useContext(q),{active:R,disabled:L,completed:I,icon:N}=u.useContext(te),A=c||N;let M=m;A&&!M&&(M=nt);const w={...s,active:R,alternativeLabel:v,completed:I,disabled:L,error:i,orientation:k},$=ot(w),z={slots:d,slotProps:{stepIcon:b,...l,...p}},[ge,je]=Q("root",{elementType:st,externalForwardedProps:{...z,...j},ownerState:w,ref:r,className:D($.root,a)}),[ye,V]=Q("label",{elementType:at,externalForwardedProps:z,ownerState:w}),[re,fe]=Q("stepIcon",{elementType:M,externalForwardedProps:z,ownerState:w});return e.jsxs(ge,{...je,children:[A||re?e.jsx(it,{className:$.iconContainer,ownerState:w,children:e.jsx(re,{completed:I,active:R,error:i,icon:A,...fe})}):null,e.jsxs(lt,{className:$.labelContainer,ownerState:w,children:[o?e.jsx(ye,{...V,className:D($.label,V==null?void 0:V.className),children:o}):null,h]})]})});be.muiName="StepLabel";function ct(t){return W("MuiStepConnector",t)}const _=O("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]),dt=t=>{const{classes:n,orientation:r,alternativeLabel:s,active:o,completed:a,disabled:l}=t,i={root:["root",r,s&&"alternativeLabel",o&&"active",a&&"completed",l&&"disabled"],line:["line",`line${ie(r)}`]};return B(i,ct,n)},pt=S("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:r}=t;return[n.root,n[r.orientation],r.alternativeLabel&&n.alternativeLabel,r.completed&&n.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),xt=S("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,n)=>{const{ownerState:r}=t;return[n.line,n[`line${ie(r.orientation)}`]]}})(U(({theme:t})=>{const n=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return{display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:n,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),ve=u.forwardRef(function(n,r){const s=E({props:n,name:"MuiStepConnector"}),{className:o,...a}=s,{alternativeLabel:l,orientation:i="horizontal"}=u.useContext(q),{active:c,disabled:h,completed:d}=u.useContext(te),p={...s,alternativeLabel:l,orientation:i,active:c,completed:d,disabled:h},m=dt(p);return e.jsx(pt,{className:D(m.root,o),ref:r,ownerState:p,...a,children:e.jsx(xt,{className:m.line,ownerState:p})})});function ht(t){return W("MuiStepper",t)}O("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const mt=t=>{const{orientation:n,nonLinear:r,alternativeLabel:s,classes:o}=t;return B({root:["root",n,r&&"nonLinear",s&&"alternativeLabel"]},ht,o)},ut=S("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:r}=t;return[n.root,n[r.orientation],r.alternativeLabel&&n.alternativeLabel,r.nonLinear&&n.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),bt=e.jsx(ve,{}),vt=u.forwardRef(function(n,r){const s=E({props:n,name:"MuiStepper"}),{activeStep:o=0,alternativeLabel:a=!1,children:l,className:i,component:c="div",connector:h=bt,nonLinear:d=!1,orientation:p="horizontal",...m}=s,b={...s,nonLinear:d,alternativeLabel:a,orientation:p,component:c},j=mt(b),v=u.Children.toArray(l).filter(Boolean),k=v.map((L,I)=>u.cloneElement(L,{index:I,last:I+1===v.length,...L.props})),R=u.useMemo(()=>({activeStep:o,alternativeLabel:a,connector:h,nonLinear:d,orientation:p}),[o,a,h,d,p]);return e.jsx(q.Provider,{value:R,children:e.jsx(ut,{as:c,ownerState:b,className:D(j.root,i),ref:r,...m,children:k})})});function ne({onEdit:t,checkoutState:n,onApplyDiscount:r}){const{shipping:s,subtotal:o,discount:a,total:l}=n,i=s!==null?"Miễn phí":"-",c={display:"flex"};return e.jsxs(G,{sx:{mb:3},children:[e.jsx(H,{title:"Tóm tắt đơn hàng",action:t&&e.jsx(y,{size:"small",onClick:t,startIcon:e.jsx(g,{icon:"solar:pen-bold"}),children:"Chỉnh sửa"})}),e.jsxs(ee,{spacing:2,sx:{p:3},children:[e.jsxs(x,{sx:{...c},children:[e.jsx(f,{component:"span",variant:"body2",sx:{flexGrow:1,color:"text.secondary"},children:"Tạm tính"}),e.jsx(f,{component:"span",variant:"subtitle2",children:F(o)})]}),e.jsxs(x,{sx:{...c},children:[e.jsx(f,{component:"span",variant:"body2",sx:{flexGrow:1,color:"text.secondary"},children:"Phí giao hàng"}),e.jsx(f,{component:"span",variant:"subtitle2",children:s?F(s):i})]}),e.jsx(K,{sx:{borderStyle:"dashed"}}),e.jsxs(x,{sx:{...c},children:[e.jsx(f,{component:"span",variant:"subtitle1",sx:{flexGrow:1},children:"Tổng cộng"}),e.jsx(x,{sx:{textAlign:"right"},children:e.jsx(f,{component:"span",variant:"subtitle1",sx:{display:"block",color:"error.main"},children:F(l)})})]})]})]})}function gt({row:t,onDeleteCartItem:n,onChangeItemQuantity:r}){return e.jsxs(De,{children:[e.jsx(P,{children:e.jsxs(x,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Se,{variant:"rounded",alt:t.name,src:t.coverUrl,sx:{width:64,height:64}}),e.jsxs(ee,{spacing:.5,children:[e.jsx(f,{noWrap:!0,variant:"subtitle2",sx:{maxWidth:240},children:t.name}),e.jsxs(x,{sx:{display:"flex",typography:"body2",alignItems:"center",color:"text.secondary"},children:["Môn: ",e.jsxs(oe,{sx:{ml:.5},children:[" ",t.size," "]}),e.jsx(K,{orientation:"vertical",sx:{mx:1,height:16}}),e.jsxs(oe,{sx:{ml:.5},children:[" ",t.colors," "]})]})]})]})}),e.jsx(P,{children:F(t.price)}),e.jsx(P,{children:e.jsx(x,{sx:{width:100,textAlign:"right"},children:e.jsx(Fe,{hideDivider:!0,value:t.quantity,onChange:(s,o)=>r(t.id,o),max:t.available})})}),e.jsx(P,{align:"right",children:F(t.price*t.quantity)}),e.jsx(P,{align:"right",sx:{px:1},children:e.jsx(Le,{onClick:()=>n(t.id),children:e.jsx(g,{icon:"solar:trash-bin-trash-bold"})})})]})}const jt=[{id:"product",label:"Sản phẩm"},{id:"price",label:"Giá"},{id:"quantity",label:"Số lượng"},{id:"totalAmount",label:"Tổng tiền",align:"right"},{id:""}];function yt({checkoutState:t,onDeleteCartItem:n,onChangeItemQuantity:r}){return e.jsx(Ie,{children:e.jsxs(Me,{sx:{minWidth:720},children:[e.jsx(ze,{headCells:jt}),e.jsx(Pe,{children:t.items.map(s=>e.jsx(gt,{row:s,onDeleteCartItem:n,onChangeItemQuantity:r},s.id))})]})})}function ft(){const{loading:t,onChangeStep:n,onApplyDiscount:r,onDeleteCartItem:s,state:o,onChangeItemQuantity:a}=J(),l=!o.items.length,i=()=>e.jsx(x,{sx:{height:340,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{color:"inherit",sx:{width:1,maxWidth:320}})}),c=()=>e.jsx($e,{title:"Chưa có gì trong giỏ hàng!",description:"Có vẻ như bạn chưa thêm gì vào giỏ hàng.",imgUrl:`${ce.assetsDir}/assets/icons/empty/ic-cart.svg`,sx:{height:340}});return e.jsxs(C,{container:!0,spacing:3,children:[e.jsxs(C,{size:{xs:12,md:8},children:[e.jsxs(G,{sx:{mb:3},children:[e.jsx(H,{title:e.jsxs(f,{variant:"h6",children:["Giỏ hàng ",e.jsxs(f,{component:"span",sx:{color:"text.secondary"},children:["(",o.totalItems," sản phẩm)"]})]}),sx:{mb:3}}),t?i():e.jsx(e.Fragment,{children:l?c():e.jsx(yt,{checkoutState:o,onDeleteCartItem:s,onChangeItemQuantity:a})})]}),e.jsx(y,{color:"inherit",startIcon:e.jsx(g,{icon:"eva:arrow-ios-back-fill"}),onClick:()=>window.location.href="/",children:"Về trang chủ"})]}),e.jsxs(C,{size:{xs:12,md:4},children:[e.jsx(ne,{checkoutState:o,onApplyDiscount:r}),e.jsx(y,{fullWidth:!0,size:"large",type:"submit",variant:"contained",disabled:l,onClick:()=>n("next"),children:"Thanh toán"})]})]})}function Ct({steps:t,activeStep:n,sx:r,...s}){return e.jsx(vt,{alternativeLabel:!0,activeStep:n,connector:e.jsx(St,{}),sx:[{mb:{xs:3,md:5}},...Array.isArray(r)?r:[r]],...s,children:t.map(o=>e.jsx(Ze,{children:e.jsx(be,{slots:{stepIcon:Lt},sx:{[`& .${T.label}`]:{fontWeight:"fontWeightSemiBold"}},children:o})},o))})}const St=S(ve)(({theme:t})=>({top:10,left:"calc(-50% + 20px)",right:"calc(50% + 20px)",[`& .${_.line}`]:{borderTopWidth:2,borderColor:t.vars.palette.divider},[`&.${_.active}, &.${_.completed}`]:{[`& .${_.line}`]:{borderColor:t.vars.palette.primary.main}}}));function Lt({active:t,completed:n}){return e.jsx(x,{sx:{width:24,height:24,display:"flex",alignItems:"center",color:"text.disabled",justifyContent:"center",...t&&{color:"primary.main"}},children:n?e.jsx(g,{icon:"eva:checkmark-fill",sx:{color:"primary.main"}}):e.jsx(x,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:"currentColor"}})})}function It({name:t,options:n,onApplyShipping:r,sx:s,...o}){const{control:a}=he();return e.jsxs(G,{sx:s,...o,children:[e.jsx(H,{title:"Hình thức giao hàng"}),e.jsx(me,{name:t,control:a,render:({field:{value:l,onChange:i}})=>e.jsx(x,{sx:{p:3,rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:n.map(c=>e.jsx(kt,{option:c,selected:l===c.value,onClick:()=>{i(c.value),r(c.value)}},c.label))})})]})}function kt({option:t,selected:n,sx:r,...s}){return e.jsxs(x,{sx:[o=>({p:2.5,gap:2,display:"flex",cursor:"pointer",borderRadius:1.5,border:`solid 1px ${de(o.vars.palette.grey["500Channel"],.24)}`,transition:o.transitions.create(["box-shadow"],{easing:o.transitions.easing.sharp,duration:o.transitions.duration.shortest}),...n&&{boxShadow:`0 0 0 2px ${o.vars.palette.text.primary}`}}),...Array.isArray(r)?r:[r]],...s,children:[e.jsx(g,{width:28,icon:t.label==="Nhanh"&&"carbon:delivery"||t.label==="Cấp tốc"&&"carbon:rocket"||"carbon:bicycle"}),e.jsxs(x,{sx:{flex:"1 1 auto"},children:[e.jsxs(x,{sx:{mb:.5,display:"flex",typography:"h6",alignItems:"center"},children:[e.jsx(x,{component:"span",sx:{flexGrow:1,typography:"subtitle1"},children:t.label}),`${F(t.value)}`]}),e.jsx(x,{component:"span",sx:{display:"flex",typography:"body2",color:"text.secondary"},children:t.description})]})]})}function wt({checkoutState:t,onChangeStep:n,loading:r,sx:s,...o}){const{billing:a}=t,l=()=>e.jsx(x,{sx:{height:104,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{color:"inherit",sx:{width:1,maxWidth:120}})});return e.jsxs(G,{sx:[{mb:3},...Array.isArray(s)?s:[s]],...o,children:[e.jsx(H,{title:"Địa chỉ giao hàng",action:e.jsx(y,{size:"small",startIcon:e.jsx(g,{icon:"solar:pen-bold"}),onClick:()=>n("back"),children:"Chỉnh sửa"})}),e.jsx(ee,{spacing:1,sx:{p:3},children:r?l():e.jsxs(e.Fragment,{children:[e.jsxs(x,{sx:{typography:"subtitle2"},children:[`${a==null?void 0:a.name} `,e.jsxs(x,{component:"span",sx:{color:"text.secondary",typography:"body2"},children:["(",a==null?void 0:a.addressType,")"]})]}),e.jsx(x,{sx:{color:"text.secondary",typography:"body2"},children:a==null?void 0:a.fullAddress.replace(/(, )+$/,"")}),e.jsx(x,{sx:{color:"text.secondary",typography:"body2"},children:a==null?void 0:a.phoneNumber})]})})]})}function Tt({name:t,options:n,sx:r,...s}){const{control:o}=he(),a=pe(),l=ue(),[i,c]=u.useState([]);u.useEffect(()=>{const p=JSON.parse(localStorage.getItem("cards")||"[]").map((m,b)=>{var v;const j=((v=m.number)==null?void 0:v.slice(-4))||"0000";return{value:`card${b+1}`,label:`**** **** **** ${j} - ${m.holder}`}});c(p)},[]);const h=d=>{try{const p={number:d.cardNumber,holder:d.cardHolder,expiryDate:d.expiryDate,cvv:d.cvv},b=[...JSON.parse(localStorage.getItem("cards")||"[]"),p];localStorage.setItem("cards",JSON.stringify(b));const j=b.map((v,k)=>{var L;const R=((L=v.number)==null?void 0:L.slice(-4))||"0000";return{value:`card${k+1}`,label:`**** **** **** ${R} - ${v.holder}`}});c(j),a.onFalse()}catch(p){console.error(p)}};return e.jsxs(e.Fragment,{children:[e.jsxs(G,{sx:r,...s,children:[e.jsx(H,{title:"Phương thức thanh toán"}),e.jsx(me,{name:t,control:o,render:({field:{value:d,onChange:p},fieldState:{error:m}})=>e.jsxs(x,{sx:{p:3,gap:2.5,display:"flex",flexDirection:"column"},children:[n.payments.map(b=>{const j=d===b.value;return e.jsx(Rt,{option:b,selected:j,onOpen:a.onTrue,cardOptions:i,isCredit:j&&b.value==="creditcard",onClick:()=>p(b.value)},b.label)}),!!m&&e.jsx(ke,{error:!0,sx:{mt:0,px:2},children:m.message})]})})]}),e.jsxs(xe,{fullWidth:!0,maxWidth:"xs",open:a.value,onClose:a.onFalse,children:[e.jsx(Ue,{children:" Thêm thẻ "}),e.jsx(Ge,{sx:{overflow:"unset"},children:e.jsx(Oe,{...l,children:e.jsx(Be,{isRHF:!0,numberField:{name:"cardNumber"},holderField:{name:"cardHolder"},dateField:{name:"expiryDate"},cvvField:{name:"cvv"}})})}),e.jsxs(He,{children:[e.jsx(y,{color:"inherit",variant:"outlined",onClick:a.onFalse,children:"Huỷ"}),e.jsx(y,{color:"inherit",variant:"contained",onClick:l.handleSubmit(h),children:"Thêm"})]})]})]})}function Rt({sx:t,option:n,onOpen:r,selected:s,isCredit:o,cardOptions:a,...l}){return e.jsxs(x,{sx:[i=>({borderRadius:1.5,border:`solid 1px ${de(i.vars.palette.grey["500Channel"],.24)}`,transition:i.transitions.create(["box-shadow"],{easing:i.transitions.easing.sharp,duration:i.transitions.duration.shortest}),...s&&{boxShadow:`0 0 0 2px ${i.vars.palette.text.primary}`}}),...Array.isArray(t)?t:[t]],...l,children:[e.jsxs(x,{sx:{p:2.5,display:"flex",cursor:"pointer",alignItems:"flex-start"},children:[e.jsxs(x,{sx:{gap:.5,flexGrow:1,display:"flex",flexDirection:"column",typography:"subtitle1"},children:[n.label,e.jsx(x,{component:"span",sx:{typography:"body2",color:"text.secondary"},children:n.description})]}),e.jsxs(x,{sx:{gap:1,display:"flex",alignItems:"center"},children:[n.value==="creditcard"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{icon:"payments:mastercard",width:36,height:"auto"}),e.jsx(g,{icon:"payments:visa",width:36,height:"auto"})]}),n.value==="paypal"&&e.jsx(g,{icon:"payments:paypal",width:24}),n.value==="cash"&&e.jsx(g,{icon:"solar:wad-of-money-bold",width:32})]})]}),o&&e.jsxs(x,{sx:{px:3},children:[a.length>0&&e.jsx(we,{select:!0,fullWidth:!0,label:"Thẻ của bạn",slotProps:{select:{native:!0}},children:a.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),e.jsx(y,{size:"small",color:"primary",startIcon:e.jsx(g,{icon:"mingcute:add-line",sx:{mr:-.5}}),onClick:r,sx:{my:3},children:"Thêm thẻ"})]})]})}const At=[{value:0,label:"Miễn phí",description:"5-7 ngày vận chuyển"},{value:10,label:"Nhanh",description:"3-5 ngày vận chuyển"},{value:20,label:"Cấp tốc",description:"2-3 ngày vận chuyển"}],Nt=[{value:"creditcard",label:"Thẻ tín dụng / Thẻ ghi nợ",description:"Chúng tôi hỗ trợ Mastercard, Visa, Discover và Stripe."},{value:"cash",label:"Tiền mặt",description:"Thanh toán bằng tiền mặt khi đơn hàng của bạn được giao."}],$t=Z.object({payment:Z.string().min(1,{message:"Bạn chưa chọn phương thức thanh toán!"}),delivery:Z.number()});function zt(){const{loading:t,onResetCart:n,onChangeStep:r,onApplyShipping:s,state:o}=J(),a={delivery:o.shipping,payment:""},l=ue({resolver:We($t),defaultValues:a}),{handleSubmit:i,formState:{isSubmitting:c}}=l,h=i(async d=>{try{n(),r("next"),console.info("DATA",d)}catch(p){console.error(p)}});return e.jsx(Ee,{methods:l,onSubmit:h,children:e.jsxs(C,{container:!0,spacing:3,children:[e.jsxs(C,{size:{xs:12,md:8},children:[e.jsx(It,{name:"delivery",onApplyShipping:s,options:At}),e.jsx(Tt,{name:"payment",options:{payments:Nt},sx:{my:3}}),e.jsx(y,{size:"small",color:"inherit",onClick:()=>r("back"),startIcon:e.jsx(g,{icon:"eva:arrow-ios-back-fill"}),children:"Quay lại"})]}),e.jsxs(C,{size:{xs:12,md:4},children:[e.jsx(wt,{loading:t,onChangeStep:r,checkoutState:o}),e.jsx(ne,{checkoutState:o,onEdit:()=>r("go",0)}),e.jsx(y,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:c,children:"Hoàn tất đặt hàng"})]})]})})}function Ft({onResetCart:t,onDownloadPDF:n,slotProps:r,...s}){var a;const o=(a=r==null?void 0:r.paper)==null?void 0:a.sx;return e.jsx(xe,{fullWidth:!0,fullScreen:!0,slotProps:{...r,paper:{...r==null?void 0:r.paper,sx:[{width:{md:"calc(100% - 48px)"},height:{md:"calc(100% - 48px)"}},...Array.isArray(o)?o:[o]]}},...s,children:e.jsxs(x,{sx:{py:5,gap:5,m:"auto",maxWidth:480,display:"flex",textAlign:"center",alignItems:"center",px:{xs:2,sm:0},flexDirection:"column"},children:[e.jsx(f,{variant:"h4",children:"Đặt hàng thành công!"}),e.jsx(Te,{}),e.jsxs(f,{children:["Cảm ơn bạn đã đặt hàng",e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),"Chúng tôi sẽ gửi thông báo cho bạn trong vòng 5 ngày khi hàng được giao.",e.jsx("br",{})," Nếu bạn có bất kỳ câu hỏi hoặc thắc mắc nào, hãy liên hệ với chúng tôi."]}),e.jsx(K,{sx:{width:1,borderStyle:"dashed"}}),e.jsx(x,{sx:{gap:2,display:"flex",flexWrap:"wrap",justifyContent:"center"},children:e.jsx(y,{component:Re,href:"/",size:"large",color:"inherit",variant:"outlined",onClick:t,startIcon:e.jsx(g,{icon:"eva:arrow-ios-back-fill"}),children:"Trở về trang chủ"})})]})})}function Dt(){const{onChangeStep:t,onCreateBillingAddress:n,state:r}=J(),s=pe(),[o,a]=u.useState(()=>{const h=localStorage.getItem("addresses");return h?JSON.parse(h):[]}),l=o.length>0?o:Ae,i=o.length>0,c=h=>{const d=[...o];d.splice(h,1),a(d),localStorage.setItem("addresses",JSON.stringify(d))};return e.jsxs(e.Fragment,{children:[e.jsxs(C,{container:!0,spacing:3,children:[e.jsxs(C,{size:{xs:12,md:8},children:[l.slice(0,4).map((h,d)=>e.jsx(Ve,{address:h,action:e.jsxs(x,{sx:{flexShrink:0,display:"flex",flexWrap:"wrap"},children:[i&&e.jsx(y,{size:"small",color:"error",sx:{mr:1},onClick:()=>c(d),children:"Xóa"}),e.jsx(y,{variant:"outlined",size:"small",onClick:()=>{t("next"),n(h)},children:"Giao tới địa chỉ này"})]}),sx:[p=>({p:3,mb:3,borderRadius:2,boxShadow:p.vars.customShadows.card})]},h.id)),e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(y,{size:"small",color:"inherit",onClick:()=>t("back"),startIcon:e.jsx(g,{icon:"eva:arrow-ios-back-fill"}),children:"Quay lại"}),e.jsx(y,{size:"small",color:"primary",onClick:s.onTrue,startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"Thêm địa chỉ mới"})]})]}),e.jsx(C,{size:{xs:12,md:4},children:e.jsx(ne,{checkoutState:r})})]}),e.jsx(_e,{open:s.value,onClose:s.onFalse,onCreate:h=>{t("next"),n(h)}})]})}function Mt(){const{steps:t,activeStep:n,completed:r,onResetCart:s}=J();return e.jsxs(Ne,{sx:{mb:10},children:[e.jsx(f,{variant:"h4",sx:{my:{xs:3,md:5}},children:"Thanh toán"}),e.jsx(C,{container:!0,justifyContent:r?"center":"flex-start",children:e.jsx(C,{size:{xs:12,md:8},children:e.jsx(Ct,{steps:t,activeStep:n??0})})}),e.jsxs(e.Fragment,{children:[n===0&&e.jsx(ft,{}),n===1&&e.jsx(Dt,{}),n===2&&e.jsx(zt,{}),r&&e.jsx(Ft,{open:!0,onResetCart:s,onDownloadPDF:()=>{}})]})]})}const Pt={title:`Thanh toán - ${ce.appName}`};function jn(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Pt.title}),e.jsx(Mt,{})]})}export{jn as default};
