import{X as sn,Y as an,Z as v,_ as T,$ as rn,a0 as U,a1 as cn,a2 as dn,a3 as Y,a4 as J,a5 as Q,a6 as Z,a7 as G,a8 as it,a9 as K,aa as kt,ab as ln,ac as un,ad as pn,ae as mn,af as q,ag as En,ah as hn,ai as gn,aj as Ht,ak as ve,al as C,am as N,an as _,ao as jt,ap as M,aq as me,ar as fn,as as Sn,at as oe,au as Te,av as xn,aw as In,H as Ee,ax as Wt,ay as zt,O,g as _e,j as m,B as X,F as he,K as Ke,L as yn,N as He,R as je,Q as Vt,U as Ae,V as Fe,I as Ue}from"./index-BPi-lj99.js";import{s as ge,z as P}from"./zod-B_WTTuJ9.js";import{u as fe}from"./styles-BkVqaM-o.js";import{E as Rn,P as Pn,S as Cn}from"./new-password-icon-RGb_81Uz.js";import{F}from"./fields-C_OA-jBI.js";import"./preview-single-file-CNraPjvt.js";import"./code-highlight-block-CqLMdGe8.js";import{F as Se}from"./form-provider-BxIa1T6o.js";import{F as xe,S as Nn}from"./sign-up-terms-n-qzt160.js";import{F as $e}from"./form-return-link-CMgZIhB9.js";import{F as Kt}from"./form-resend-code-DEMrIQBM.js";import{g as $t}from"./error-message-CLFfVbaG.js";const wn=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:o="",architecture:s="",fullVersionList:i=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),a=i.map(r=>`${r.brand}/${r.version}`).join(";");return[t,n,s,o,t,a].filter(r=>r).join(" ")||navigator.userAgent};function vn(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const pe={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:vn(e);let o=sn()(n);return t.urlSafe&&(o=o.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(o=o.replace(/=/g,"")),o}};function Tn(){return an().getRandomValues(new Uint32Array(1))[0]}function An(e){const{words:t}=e,{sigBytes:n}=e,o=[];for(let s=0;s<n;s++){const i=t[s>>>2]>>>24-s%4*8&255;o.push((i>>>4).toString(16)),o.push((i&15).toString(16))}return o.join("")}class Ye{constructor(t,n){this.words=[];let o=t;o=this.words=o||[],n!==void 0?this.sigBytes=n:this.sigBytes=o.length*4}random(t){const n=[];for(let o=0;o<t;o+=4)n.push(Tn());return new Ye(n,t)}toString(){return An(this)}}var f;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(f||(f={}));const Yt={[f.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[f.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[f.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[f.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[f.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[f.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[f.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[f.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[f.EmptySignInPassword]:{message:"password is required to signIn"},[f.EmptySignInUsername]:{message:"username is required to signIn"},[f.EmptySignUpPassword]:{message:"password is required to signUp"},[f.EmptySignUpUsername]:{message:"username is required to signUp"},[f.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[f.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[f.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[f.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[f.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var at;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(at||(at={}));var te;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(te||(te={}));function R(e,t){const{message:n,recoverySuggestion:o}=Yt[t];if(!e)throw new v({name:t,message:n,recoverySuggestion:o})}function rt(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var ct;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(ct||(ct={}));var dt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(dt||(dt={}));var lt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(lt||(lt={}));var ut;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ut||(ut={}));var pt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(pt||(pt={}));var mt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(mt||(mt={}));var Et;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Et||(Et={}));var ht;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ht||(ht={}));var gt;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(gt||(gt={}));var ft;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ft||(ft={}));var St;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(St||(St={}));var xt;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(xt||(xt={}));var It;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(It||(It={}));var yt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(yt||(yt={}));var be;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(be||(be={}));var Rt;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Rt||(Rt={}));var Pt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Pt||(Pt={}));var Ct;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ct||(Ct={}));var We;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(We||(We={}));var Nt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Nt||(Nt={}));var wt;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(wt||(wt={}));var vt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(vt||(vt={}));var Tt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Tt||(Tt={}));var At;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(At||(At={}));const Fn=async e=>{var c,r;const t=(c=e.getConfig().Auth)==null?void 0:c.Cognito;T(t);const n=await e.Auth.getTokens({forceRefresh:!1});rn(n);const{"cognito:username":o,sub:s}=((r=n.idToken)==null?void 0:r.payload)??{},i={username:o,userId:s},a=Un(n);return a&&(i.signInDetails=a),i};function Un(e){return e==null?void 0:e.signInDetails}const Jt=async()=>Fn(U),D=(e,t)=>cn({category:dn.Auth,action:e,...t}),De=e=>Y(G,Z("RespondToAuthChallenge"),Q(),{...J,...e}),bn=e=>Y(G,Z("AssociateSoftwareToken"),Q(),{...J,...e});async function se(e){if(e.AccessToken){const t=it(e.AccessToken),n=(t.payload.iat||0)*1e3,o=new Date().getTime(),s=n>0?n-o:0;let i,a,c;e.RefreshToken&&(a=e.RefreshToken),e.IdToken&&(i=it(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(c=e.NewDeviceMetadata);const r={accessToken:t,idToken:i,refreshToken:a,clockDrift:s,deviceMetadata:c,username:e.username};e!=null&&e.signInDetails&&(r.signInDetails=e.signInDetails),await K.setTokens({tokens:r})}else throw new kt({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const Mn="Unable to get user session following successful sign-in.",ie=async()=>{try{ln.dispatch("auth",{event:"signedIn",data:await Jt()},"Auth",un)}catch(e){throw e.name===pn?new v({name:mn,message:Mn,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function Zt(){return{active:!1}}const _n=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return Zt();default:return e}},Dn=e=>{let t=e(Zt(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},z=Dn(_n),On=3*60*1e3,Pe="CognitoSignInState",k={username:`${Pe}.username`,challengeName:`${Pe}.challengeName`,signInSession:`${Pe}.signInSession`,expiry:`${Pe}.expiry`},Ln=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return Ce({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return Ce(t.value),{...t.value};case"SET_CHALLENGE_NAME":return Ce({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return Ce({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return qn();case"RESET_STATE":return Gt(),Je();default:return e}},Bn=e=>{const t=Number(e),n=Date.now();return t<=n},L=()=>{$.dispatch({type:"RESET_STATE"})},Gt=()=>{for(const e of Object.values(k))q.removeItem(e)},Je=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),qn=()=>{const e=q.getItem(k.expiry);if(!e||Bn(e))return Gt(),Je();const t=q.getItem(k.username)??void 0,n=q.getItem(k.challengeName)??void 0,o=q.getItem(k.signInSession)??void 0;return{username:t,challengeName:n,signInSession:o}},kn=e=>{let t=e(Je(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},$=kn(Ln);function ae(e){$.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const Ce=({challengeName:e,signInSession:t,username:n})=>{n&&q.setItem(k.username,n),e&&q.setItem(k.challengeName,e),t&&(q.setItem(k.signInSession,t),q.setItem(k.expiry,String(Date.now()+On)))};class H extends kt{constructor(t){super(t),this.constructor=H,Object.setPrototypeOf(this,H.prototype)}}var y;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(y||(y={}));const Ft="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",qe="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",Ut="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",Me={[y.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:Ft},[y.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:Ut},[y.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:Ut},[y.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:Ft},[y.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[y.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[y.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:qe},[y.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:qe},[y.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:qe},[y.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},Ze=En(Me,H),Hn=e=>{if(e instanceof H)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:n}=Me[y.PasskeyAuthenticationCanceled];return new H({name:y.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return jn(e)},jn=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:n}=Me[y.PasskeyOperationAborted];return new H({name:y.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:n}=Me[y.RelyingPartyMismatch];return new H({name:y.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new H({name:hn.Unknown,message:"An unknown error has occurred.",underlyingError:e})},Wn=()=>gn()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",ue=e=>pe.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),bt=e=>Uint8Array.from(Ht.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,zn=e=>{const t=bt(e.challenge),n=(e.allowCredentials||[]).map(o=>({...o,id:bt(o.id)}));return{...e,challenge:t,allowCredentials:n}},Vn=e=>{const t={clientDataJSON:ue(e.response.clientDataJSON),authenticatorData:ue(e.response.authenticatorData),signature:ue(e.response.signature)};e.response.userHandle&&(t.userHandle=ue(e.response.userHandle));const n={id:e.id,rawId:ue(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n};function Kn(e){Ze(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,y.PasskeyRetrievalFailed)}const $n=async e=>{try{const t=Wn();Ze(t,y.PasskeyNotSupported);const n=zn(e),o=await navigator.credentials.get({publicKey:n});return Kn(o),Vn(o)}catch(t){throw Hn(t)}},Yn=e=>Y(G,Z("ConfirmDevice"),Q(),{...J,...e}),Ne={convert(e){return new TextEncoder().encode(e)}};function E(e,t){e!=null&&this.fromString(e,t)}function w(){return new E(null,null)}let V;const Jn=0xdeadbeefcafe,Mt=(Jn&16777215)===15715070;function Zn(e,t,n,o,s,i){for(;--i>=0;){const a=t*this[e++]+n[o]+s;s=Math.floor(a/67108864),n[o++]=a&67108863}return s}function Gn(e,t,n,o,s,i){const a=t&32767,c=t>>15;for(;--i>=0;){let r=this[e]&32767;const d=this[e++]>>15,l=c*r+d*a;r=a*r+((l&32767)<<15)+n[o]+(s&1073741823),s=(r>>>30)+(l>>>15)+c*d+(s>>>30),n[o++]=r&1073741823}return s}function Xn(e,t,n,o,s,i){const a=t&16383,c=t>>14;for(;--i>=0;){let r=this[e]&16383;const d=this[e++]>>14,l=c*r+d*a;r=a*r+((l&16383)<<14)+n[o]+s,s=(r>>28)+(l>>14)+c*d,n[o++]=r&268435455}return s}const _t=typeof navigator<"u";_t&&Mt&&navigator.appName==="Microsoft Internet Explorer"?(E.prototype.am=Gn,V=30):_t&&Mt&&navigator.appName!=="Netscape"?(E.prototype.am=Zn,V=26):(E.prototype.am=Xn,V=28);E.prototype.DB=V;E.prototype.DM=(1<<V)-1;E.prototype.DV=1<<V;const Ge=52;E.prototype.FV=Math.pow(2,Ge);E.prototype.F1=Ge-V;E.prototype.F2=2*V-Ge;const Qn="0123456789abcdefghijklmnopqrstuvwxyz",Oe=[];let re,b;re=48;for(b=0;b<=9;++b)Oe[re++]=b;re=97;for(b=10;b<36;++b)Oe[re++]=b;re=65;for(b=10;b<36;++b)Oe[re++]=b;function Dt(e){return Qn.charAt(e)}function eo(e,t){const n=Oe[e.charCodeAt(t)];return n??-1}function to(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function no(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Xe(e){const t=w();return t.fromInt(e),t}function oo(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let o=e.length,s=!1,i=0;for(;--o>=0;){const a=eo(e,o);if(a<0){e.charAt(o)==="-"&&(s=!0);continue}s=!1,i===0?this[this.t++]=a:i+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-i)-1)<<i,this[this.t++]=a>>this.DB-i):this[this.t-1]|=a<<i,i+=n,i>=this.DB&&(i-=this.DB)}this.clamp(),s&&E.ZERO.subTo(this,this)}function so(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function io(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let o,s=!1,i="",a=this.t,c=this.DB-a*this.DB%t;if(a-- >0)for(c<this.DB&&(o=this[a]>>c)>0&&(s=!0,i=Dt(o));a>=0;)c<t?(o=(this[a]&(1<<c)-1)<<t-c,o|=this[--a]>>(c+=this.DB-t)):(o=this[a]>>(c-=t)&n,c<=0&&(c+=this.DB,--a)),o>0&&(s=!0),s&&(i+=Dt(o));return s?i:"0"}function ao(){const e=w();return E.ZERO.subTo(this,e),e}function ro(){return this.s<0?this.negate():this}function co(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function Qe(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function lo(){return this.t<=0?0:this.DB*(this.t-1)+Qe(this[this.t-1]^this.s&this.DM)}function uo(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function po(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function mo(e,t){const n=e%this.DB,o=this.DB-n,s=(1<<o)-1,i=Math.floor(e/this.DB);let a=this.s<<n&this.DM,c;for(c=this.t-1;c>=0;--c)t[c+i+1]=this[c]>>o|a,a=(this[c]&s)<<n;for(c=i-1;c>=0;--c)t[c]=0;t[i]=a,t.t=this.t+i+1,t.s=this.s,t.clamp()}function Eo(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const o=e%this.DB,s=this.DB-o,i=(1<<o)-1;t[0]=this[n]>>o;for(let a=n+1;a<this.t;++a)t[a-n-1]|=(this[a]&i)<<s,t[a-n]=this[a]>>o;o>0&&(t[this.t-n-1]|=(this.s&i)<<s),t.t=this.t-n,t.clamp()}function ho(e,t){let n=0,o=0;const s=Math.min(e.t,this.t);for(;n<s;)o+=this[n]-e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o-=e[n],t[n++]=o&this.DM,o>>=this.DB;o-=e.s}t.s=o<0?-1:0,o<-1?t[n++]=this.DV+o:o>0&&(t[n++]=o),t.t=n,t.clamp()}function go(e,t){const n=this.abs(),o=e.abs();let s=n.t;for(t.t=s+o.t;--s>=0;)t[s]=0;for(s=0;s<o.t;++s)t[s+n.t]=n.am(0,o[s],t,s,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&E.ZERO.subTo(t,t)}function fo(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const o=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function So(e,t,n){const o=e.abs();if(o.t<=0)return;const s=this.abs();if(s.t<o.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=w());const i=w(),a=this.s,c=e.s,r=this.DB-Qe(o[o.t-1]);r>0?(o.lShiftTo(r,i),s.lShiftTo(r,n)):(o.copyTo(i),s.copyTo(n));const d=i.t,l=i[d-1];if(l===0)return;const u=l*(1<<this.F1)+(d>1?i[d-2]>>this.F2:0),p=this.FV/u,h=(1<<this.F1)/u,g=1<<this.F2;let S=n.t,x=S-d;const I=t===null?w():t;for(i.dlShiftTo(x,I),n.compareTo(I)>=0&&(n[n.t++]=1,n.subTo(I,n)),E.ONE.dlShiftTo(d,I),I.subTo(i,i);i.t<d;)i[i.t++]=0;for(;--x>=0;){let A=n[--S]===l?this.DM:Math.floor(n[S]*p+(n[S-1]+g)*h);if((n[S]+=i.am(0,A,n,x,0,d))<A)for(i.dlShiftTo(x,I),n.subTo(I,n);n[S]<--A;)n.subTo(I,n)}t!==null&&(n.drShiftTo(d,t),a!==c&&E.ZERO.subTo(t,t)),n.t=d,n.clamp(),r>0&&n.rShiftTo(r,n),a<0&&E.ZERO.subTo(n,n)}function xo(e){const t=w();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(E.ZERO)>0&&e.subTo(t,t),t}function Io(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function yo(e){return this.compareTo(e)===0}function Ro(e,t){let n=0,o=0;const s=Math.min(e.t,this.t);for(;n<s;)o+=this[n]+e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o+=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o+=e[n],t[n++]=o&this.DM,o>>=this.DB;o+=e.s}t.s=o<0?-1:0,o>0?t[n++]=o:o<-1&&(t[n++]=this.DV+o),t.t=n,t.clamp()}function Po(e){const t=w();return this.addTo(e,t),t}function Co(e){const t=w();return this.subTo(e,t),t}function No(e){const t=w();return this.multiplyTo(e,t),t}function wo(e){const t=w();return this.divRemTo(e,t,null),t}function ce(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function vo(e){const t=w();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(E.ZERO)>0&&this.m.subTo(t,t),t}function To(e){const t=w();return e.copyTo(t),this.reduce(t),t}function Ao(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,o,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Fo(e,t){e.squareTo(t),this.reduce(t)}function Uo(e,t,n){e.multiplyTo(t,n),this.reduce(n)}ce.prototype.convert=vo;ce.prototype.revert=To;ce.prototype.reduce=Ao;ce.prototype.mulTo=Uo;ce.prototype.sqrTo=Fo;function bo(e,t,n){let o=e.bitLength(),s,i=Xe(1);const a=new ce(t);if(o<=0)return i;o<18?s=1:o<48?s=3:o<144?s=4:o<768?s=5:s=6;const c=[];let r=3;const d=s-1,l=(1<<s)-1;if(c[1]=a.convert(this),s>1){const I=w();for(a.sqrTo(c[1],I);r<=l;)c[r]=w(),a.mulTo(I,c[r-2],c[r]),r+=2}let u=e.t-1,p,h=!0,g=w(),S;for(o=Qe(e[u])-1;u>=0;){for(o>=d?p=e[u]>>o-d&l:(p=(e[u]&(1<<o+1)-1)<<d-o,u>0&&(p|=e[u-1]>>this.DB+o-d)),r=s;(p&1)===0;)p>>=1,--r;if((o-=r)<0&&(o+=this.DB,--u),h)c[p].copyTo(i),h=!1;else{for(;r>1;)a.sqrTo(i,g),a.sqrTo(g,i),r-=2;r>0?a.sqrTo(i,g):(S=i,i=g,g=S),a.mulTo(g,c[p],i)}for(;u>=0&&(e[u]&1<<o)===0;)a.sqrTo(i,g),S=i,i=g,g=S,--o<0&&(o=this.DB-1,--u)}const x=a.revert(i);return n(null,x),x}E.prototype.copyTo=to;E.prototype.fromInt=no;E.prototype.fromString=oo;E.prototype.clamp=so;E.prototype.dlShiftTo=uo;E.prototype.drShiftTo=po;E.prototype.lShiftTo=mo;E.prototype.rShiftTo=Eo;E.prototype.subTo=ho;E.prototype.multiplyTo=go;E.prototype.squareTo=fo;E.prototype.divRemTo=So;E.prototype.invDigit=Io;E.prototype.addTo=Ro;E.prototype.toString=io;E.prototype.negate=ao;E.prototype.abs=ro;E.prototype.compareTo=co;E.prototype.bitLength=lo;E.prototype.mod=xo;E.prototype.equals=yo;E.prototype.add=Po;E.prototype.subtract=Co;E.prototype.multiply=No;E.prototype.divide=wo;E.prototype.modPow=bo;E.ZERO=Xe(0);E.ONE=Xe(1);const Mo=async({a:e,g:t,k:n,x:o,B:s,N:i,U:a})=>new Promise((c,r)=>{t.modPow(o,i,(d,l)=>{if(d){r(d);return}s.subtract(n.multiply(l)).modPow(e.add(a.multiply(o)),i,(u,p)=>{if(u){r(u);return}c(p.mod(i))})})}),_o="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",Xt={},ze={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Xt[e]=t,ze[t]=e}const ne=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const o=e.slice(n,n+2).toLowerCase();if(o in ze)t[n/2]=ze[o];else throw new Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`)}return t},et=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Xt[e[n]];return t},Ve=e=>{const t=new ve;t.update(e);const n=t.digestSync(),o=et(n);return new Array(64-o.length).join("0")+o},we=e=>Ve(ne(e)),Do=/^[89a-f]/i,B=e=>{if(!(e instanceof E))throw new Error("Not a BigInteger");const t=e.compareTo(E.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Do.test(n)?`00${n}`:n,t){const o=n.split("").map(i=>{const a=~parseInt(i,16)&15;return"0123456789ABCDEF".charAt(a)}).join("");n=new E(o,16).add(E.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},Oo=({A:e,B:t})=>{const n=new E(we(B(e)+B(t)),16);if(n.equals(E.ZERO))throw new Error("U cannot be zero.");return n},Lo=(e,t,n)=>{const o=new ve(t);o.update(e);const s=o.digestSync(),i=new ve(s);return i.update(n),i.digestSync().slice(0,16)},tt=e=>{const t=new Ye().random(e).toString();return ne(t)},Bo=()=>pe.convert(tt(40));class qo{constructor({userPoolName:t,a:n,g:o,A:s,N:i}){this.encoder=Ne,this.userPoolName=t,this.a=n,this.g=o,this.A=s,this.N=i,this.k=new E(we(`${B(i)}${B(o)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new v({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new v({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new v({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=Bo();const o=`${t}${n}:${this.randomPassword}`,s=Ve(o),i=et(tt(16));return this.saltToHashDevices=B(new E(i,16)),new Promise((a,c)=>{this.g.modPow(new E(we(this.saltToHashDevices+s),16),this.N,(r,d)=>{if(r){c(r);return}this.verifierDevices=B(d),a()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:o,salt:s}){if(o.mod(this.N).equals(E.ZERO))throw new Error("B cannot be zero.");const i=Oo({A:this.A,B:o}),a=`${this.userPoolName}${t}:${n}`,c=Ve(a),r=new E(we(B(s)+c),16),d=await Mo({a:this.a,g:this.g,k:this.k,x:r,B:o,N:this.N,U:i}),l=this.encoder.convert("Caldera Derived Key"),u=this.encoder.convert(""),p=new Uint8Array(l.byteLength+u.byteLength);return p.set(l,0),p.set(u,l.byteLength),Lo(ne(B(d)),ne(B(i)),p)}}const ko=async({a:e,g:t,N:n})=>new Promise((o,s)=>{t.modPow(e,n,(i,a)=>{if(i){s(i);return}if(a.mod(n).equals(E.ZERO)){s(new Error("Illegal parameter. A mod N cannot be 0."));return}o(a)})}),Le=async e=>{const t=new E(_o,16),n=new E("2",16),o=Ho(),s=await ko({a:o,g:n,N:t});return new qo({userPoolName:e,a:o,g:n,A:s,N:t})},Ho=()=>{const e=et(tt(128));return new E(e,16)};async function de({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:o}){if(!n)return;const s=e.split("_")[1]||"",i=await Le(s),a=n==null?void 0:n.DeviceKey,c=n==null?void 0:n.DeviceGroupKey;try{await i.generateHashDevice(c??"",a??"")}catch{return}const r={Salt:pe.convert(ne(i.getSaltToHashDevices())),PasswordVerifier:pe.convert(ne(i.getVerifierDevices()))},d=i.getRandomPassword();try{return await Yn({endpointResolver:C({endpointOverride:t})})({region:N(e)},{AccessToken:o,DeviceName:await wn(),DeviceKey:n==null?void 0:n.DeviceKey,DeviceSecretVerifierConfig:r}),{deviceKey:a,deviceGroupKey:c,randomPassword:d}}catch{return}}async function jo(e){var h;const t=(h=U.getConfig().Auth)==null?void 0:h.Cognito;T(t);const{username:n,signInSession:o,signInDetails:s,challengeName:i}=$.getState();if(i!=="WEB_AUTHN"||!n)throw new v({name:te.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:a}=e;Ze(!!a,y.InvalidPasskeyAuthenticationOptions);const c=await $n(JSON.parse(a)),r=De({endpointResolver:C({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:d,ChallengeParameters:l,AuthenticationResult:u,Session:p}=await r({region:N(t.userPoolId),userAgentValue:D(_.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(c)},ClientId:t.userPoolClientId,Session:o});if(ae({signInSession:p,username:n,challengeName:d,signInDetails:s}),u)return await se({...u,username:n,NewDeviceMetadata:await de({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:u.NewDeviceMetadata,accessToken:u.AccessToken}),signInDetails:s}),$.dispatch({type:"RESET_STATE"}),await ie(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(d==="WEB_AUTHN")throw new v({name:te.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:d,challengeParameters:l}}const Wo=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],zo=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Qt=()=>{const e=new Date,t=zo[e.getUTCDay()],n=Wo[e.getUTCMonth()],o=e.getUTCDate();let s=e.getUTCHours();s<10&&(s=`0${s}`);let i=e.getUTCMinutes();i<10&&(i=`0${i}`);let a=e.getUTCSeconds();a<10&&(a=`0${a}`);const c=e.getUTCFullYear();return`${t} ${n} ${o} ${s}:${i}:${a} UTC ${c}`},en=({userPoolName:e,username:t,challengeParameters:n,dateNow:o,hkdf:s})=>{const i=Ne.convert(e),a=Ne.convert(t),c=Vo(n.SECRET_BLOCK),r=Ne.convert(o),d=new Uint8Array(i.byteLength+a.byteLength+c.byteLength+r.byteLength);d.set(i,0),d.set(a,i.byteLength),d.set(c,i.byteLength+a.byteLength),d.set(r,i.byteLength+a.byteLength+c.byteLength);const l=new ve(s);l.update(d);const u=l.digestSync();return pe.convert(u)},Vo=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),o=Ht.convert(n),s=new Uint8Array(o.length);for(let i=0;i<o.length;++i)s[i]=o.charCodeAt(i);return s};async function nt({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:s}){const{userPoolId:i,userPoolEndpoint:a}=t,c=t.userPoolClientId,r=await(s==null?void 0:s.getDeviceMetadata(e));jt(r);const d=await Le(r.deviceGroupKey),l={USERNAME:e,SRP_A:d.A.toString(16),DEVICE_KEY:r.deviceKey},u={ChallengeName:"DEVICE_SRP_AUTH",ClientId:c,ChallengeResponses:l,ClientMetadata:n,Session:o},p=De({endpointResolver:C({endpointOverride:a})}),{ChallengeParameters:h,Session:g}=await p({region:N(i)},u);return Ko(e,h,n,g,d,t,s)}async function Ko(e,t,n,o,s,{userPoolId:i,userPoolClientId:a,userPoolEndpoint:c},r){const d=await(r==null?void 0:r.getDeviceMetadata(e));jt(d);const l=new E(t==null?void 0:t.SRP_B,16),u=new E(t==null?void 0:t.SALT,16),{deviceKey:p}=d,{deviceGroupKey:h}=d,g=await s.getPasswordAuthenticationKey({username:d.deviceKey,password:d.randomPassword,serverBValue:l,salt:u}),S=Qt(),x={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:S,PASSWORD_CLAIM_SIGNATURE:en({username:p,userPoolName:h,challengeParameters:t,dateNow:S,hkdf:g}),DEVICE_KEY:p},I=M({username:e,userPoolId:i,userPoolClientId:a}),A={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:a,ChallengeResponses:x,Session:o,ClientMetadata:n,UserContextData:I};return De({endpointResolver:C({endpointOverride:c})})({region:N(i)},A)}async function tn(e,t,n,o,s,i,a){const{userPoolId:c,userPoolClientId:r,userPoolEndpoint:d}=i,l=(c==null?void 0:c.split("_")[1])||"",u=new E(t==null?void 0:t.SRP_B,16),p=new E(t==null?void 0:t.SALT,16),h=t==null?void 0:t.USER_ID_FOR_SRP;if(!h)throw new v({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const g=await s.getPasswordAuthenticationKey({username:h,password:e,serverBValue:u,salt:p}),S=Qt(),x={USERNAME:h,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:S,PASSWORD_CLAIM_SIGNATURE:en({username:h,userPoolName:l,challengeParameters:t,dateNow:S,hkdf:g})},I=await a.getDeviceMetadata(h);I&&I.deviceKey&&(x.DEVICE_KEY=I.deviceKey);const A=M({username:h,userPoolId:c,userPoolClientId:r}),W={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:x,ClientMetadata:n,Session:o,ClientId:r,UserContextData:A},ee=await De({endpointResolver:C({endpointOverride:d})})({region:N(c)},W);return ee.ChallengeName==="DEVICE_SRP_AUTH"?nt({username:h,config:i,clientMetadata:n,session:ee.Session,tokenOrchestrator:a}):ee}async function Be(e,t,n,o){try{return await e(...t)}catch(s){if(s instanceof v&&s.name==="ResourceNotFoundException"&&s.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw s}}function Ie(e){const{dispatch:t}=$;t({type:"SET_USERNAME",value:e})}async function nn({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:s,authFlow:i,preferredChallenge:a}){const{userPoolId:c,userPoolClientId:r,userPoolEndpoint:d}=o,l=(c==null?void 0:c.split("_")[1])||"",u=await Le(l),p={USERNAME:e,SRP_A:u.A.toString(16)};i==="USER_AUTH"&&a&&(p.PREFERRED_CHALLENGE=a);const h=M({username:e,userPoolId:c,userPoolClientId:r}),g={AuthFlow:i,AuthParameters:p,ClientMetadata:n,ClientId:r,UserContextData:h},x=await me({endpointResolver:C({endpointOverride:d})})({region:N(c),userAgentValue:D(_.SignIn)},g),{ChallengeParameters:I,Session:A}=x,W=(I==null?void 0:I.USERNAME)??e;return Ie(W),x.ChallengeName==="PASSWORD_VERIFIER"?Be(tn,[t,I,n,A,u,o,s],W,s):x}const Ot="userAttributes.";function $o(e){return"isSignedIn"in e&&"nextStep"in e}async function Yo(e,t,n,o,s){var S,x;const{userPoolClientId:i,userPoolId:a,userPoolEndpoint:c}=o,r={USERNAME:e,PASSWORD:t},d=await s.getDeviceMetadata(e);d&&d.deviceKey&&(r.DEVICE_KEY=d.deviceKey);const l=M({username:e,userPoolId:a,userPoolClientId:i}),u={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:r,ClientMetadata:n,ClientId:i,UserContextData:l},h=await me({endpointResolver:C({endpointOverride:c})})({region:N(a),userAgentValue:D(_.SignIn)},u),g=((S=h.ChallengeParameters)==null?void 0:S.USERNAME)??((x=h.ChallengeParameters)==null?void 0:x.USER_ID_FOR_SRP)??e;return Ie(g),h.ChallengeName==="DEVICE_SRP_AUTH"?nt({username:g,config:o,clientMetadata:n,session:h.Session,tokenOrchestrator:s}):h}async function Jo(e,t,n,o,s){return nn({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:s,authFlow:"USER_SRP_AUTH"})}async function Zo(e,t,n,o){var g;const{userPoolClientId:s,userPoolId:i,userPoolEndpoint:a}=n,c={USERNAME:e},r=await o.getDeviceMetadata(e);r&&r.deviceKey&&(c.DEVICE_KEY=r.deviceKey);const d=M({username:e,userPoolId:i,userPoolClientId:s}),l={AuthFlow:"CUSTOM_AUTH",AuthParameters:c,ClientMetadata:t,ClientId:s,UserContextData:d},p=await me({endpointResolver:C({endpointOverride:a})})({region:N(i),userAgentValue:D(_.SignIn)},l),h=((g=p.ChallengeParameters)==null?void 0:g.USERNAME)??e;return Ie(h),p.ChallengeName==="DEVICE_SRP_AUTH"?nt({username:h,config:n,clientMetadata:t,session:p.Session,tokenOrchestrator:o}):p}async function Go(e,t,n,o,s){T(o);const{userPoolId:i,userPoolClientId:a,userPoolEndpoint:c}=o,r=(i==null?void 0:i.split("_")[1])||"",d=await Le(r),l={USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},u=M({username:e,userPoolId:i,userPoolClientId:a}),p={AuthFlow:"CUSTOM_AUTH",AuthParameters:l,ClientMetadata:n,ClientId:a,UserContextData:u},h=me({endpointResolver:C({endpointOverride:c})}),{ChallengeParameters:g,Session:S}=await h({region:N(i),userAgentValue:D(_.SignIn)},p),x=(g==null?void 0:g.USERNAME)??e;return Ie(x),Be(tn,[t,g,n,S,d,o,s],x,s)}async function le(e){var i;const{challengeName:t,challengeParameters:n,availableChallenges:o}=e,s=(i=U.getConfig().Auth)==null?void 0:i.Cognito;switch(T(s),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:a,username:c}=$.getState(),r=Lt(Bt(n.MFAS_CAN_SETUP))||[],d=ts(r),l=d.includes("TOTP"),u=d.includes("EMAIL");if(l&&u)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:d}};if(u)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(l){const p=bn({endpointResolver:C({endpointOverride:s.userPoolEndpoint})}),{Session:h,SecretCode:g}=await p({region:N(s.userPoolId)},{Session:a});return $.dispatch({type:"SET_SIGN_IN_SESSION",value:h}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:Xo(g,c)}}}throw new v({name:te.SignInException,message:`Cannot initiate MFA setup from available types: ${r}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:Qo(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Lt(Bt(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const a=await jo(n);return $o(a)?a:le(a)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:o}}}throw new v({name:te.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function Xo(e,t){return{sharedSecret:e,getSetupUri:(n,o)=>{const s=`otpauth://totp/${n}:${o??t}?secret=${e}&issuer=${n}`;return new Sn(s)}}}function ye(e){if(e===be.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===be.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function Qo(e){return e?JSON.parse(e).map(n=>n.includes(Ot)?n.replace(Ot,""):n):[]}function es(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function Lt(e){if(e)return e.map(es).filter(Boolean)}function Bt(e){return e?JSON.parse(e):[]}function ts(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function ns(){let e;try{e=await Jt()}catch{}if(e&&e.userId&&e.username)throw new v({name:fn,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function Re(e){return $.getState().username??e}async function os(e){var c;const t=(c=U.getConfig().Auth)==null?void 0:c.Cognito;T(t);const{username:n,password:o,options:s}=e,i={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},a=s==null?void 0:s.clientMetadata;R(!!n,f.EmptySignInUsername),R(!o,f.CustomAuthSignInPassword);try{const{ChallengeName:r,ChallengeParameters:d,AuthenticationResult:l,Session:u}=await Be(Zo,[n,a,t,K],n,K),p=Re(n);return ae({signInSession:u,username:p,challengeName:r,signInDetails:i}),l?(await se({username:p,...l,NewDeviceMetadata:await de({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),L(),await ie(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):le({challengeName:r,challengeParameters:d})}catch(r){L(),oe(r);const d=ye(r.name);if(d)return d;throw r}}async function ss(e){var c;const{username:t,password:n,options:o}=e,s={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},i=(c=U.getConfig().Auth)==null?void 0:c.Cognito;T(i);const a=o==null?void 0:o.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:r,ChallengeParameters:d,AuthenticationResult:l,Session:u}=await Go(t,n,a,i,K),p=Re(t);return ae({signInSession:u,username:p,challengeName:r,signInDetails:s}),l?(await se({username:p,...l,NewDeviceMetadata:await de({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),L(),await ie(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):le({challengeName:r,challengeParameters:d})}catch(r){L(),oe(r);const d=ye(r.name);if(d)return d;throw r}}function j(e=!0){z.dispatch({type:"RESET"})}async function qt(e){var a,c;const{username:t,password:n}=e,o=(a=U.getConfig().Auth)==null?void 0:a.Cognito,s={loginId:t,authFlowType:"USER_SRP_AUTH"};T(o);const i=(c=e.options)==null?void 0:c.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:r,ChallengeParameters:d,AuthenticationResult:l,Session:u}=await Jo(t,n,i,o,K),p=Re(t);return ae({signInSession:u,username:p,challengeName:r,signInDetails:s}),l?(await se({username:p,...l,NewDeviceMetadata:await de({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),L(),await ie(),j(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):le({challengeName:r,challengeParameters:d})}catch(r){L(),j(),oe(r);const d=ye(r.name);if(d)return d;throw r}}async function is(e){var c;const{username:t,password:n,options:o}=e,s=(c=U.getConfig().Auth)==null?void 0:c.Cognito,i={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};T(s);const a=o==null?void 0:o.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:r,ChallengeParameters:d,AuthenticationResult:l,Session:u}=await Be(Yo,[t,n,a,s,K],t,K),p=Re(t);return ae({signInSession:u,username:p,challengeName:r,signInDetails:i}),l?(await se({...l,username:p,NewDeviceMetadata:await de({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),L(),await ie(),j(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):le({challengeName:r,challengeParameters:d})}catch(r){L(),j(),oe(r);const d=ye(r.name);if(d)return d;throw r}}async function as({username:e,clientMetadata:t,config:n,tokenOrchestrator:o,preferredChallenge:s,password:i,session:a}){const{userPoolId:c,userPoolClientId:r,userPoolEndpoint:d}=n,l=M({username:e,userPoolId:c,userPoolClientId:r}),u={USERNAME:e};if(s){if(s==="PASSWORD_SRP")return R(!!i,f.EmptySignInPassword),nn({username:e,password:i,clientMetadata:t,config:n,tokenOrchestrator:o,authFlow:"USER_AUTH",preferredChallenge:s});s==="PASSWORD"&&(R(!!i,f.EmptySignInPassword),u.PASSWORD=i),u.PREFERRED_CHALLENGE=s}const p={AuthFlow:"USER_AUTH",AuthParameters:u,ClientMetadata:t,ClientId:r,UserContextData:l};a&&(p.Session=a);const g=await me({endpointResolver:C({endpointOverride:d})})({region:N(c),userAgentValue:D(_.SignIn)},p);return Ie(e),g}async function rs(e){var r;const{username:t,password:n,options:o}=e,s=(r=U.getConfig().Auth)==null?void 0:r.Cognito,i={loginId:t,authFlowType:"USER_AUTH"};T(s);const a=o==null?void 0:o.clientMetadata,c=o==null?void 0:o.preferredChallenge;R(!!t,f.EmptySignInUsername);try{const d={username:t,config:s,tokenOrchestrator:K,clientMetadata:a,preferredChallenge:c,password:n},l=z.getState();l.active&&l.username===t&&(d.session=l.session);const u=await as(d),p=Re(t);return ae({signInSession:u.Session,username:p,challengeName:u.ChallengeName,signInDetails:i}),u.AuthenticationResult?(await se({username:p,...u.AuthenticationResult,NewDeviceMetadata:await de({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:u.AuthenticationResult.NewDeviceMetadata,accessToken:u.AuthenticationResult.AccessToken}),signInDetails:i}),L(),await ie(),j(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):le({challengeName:u.ChallengeName,challengeParameters:u.ChallengeParameters,availableChallenges:"AvailableChallenges"in u?u.AvailableChallenges:void 0})}catch(d){L(),j(),oe(d);const l=ye(d.name);if(l)return l;throw d}}async function cs(e){var n;j(!1);const t=(n=e.options)==null?void 0:n.authFlowType;switch(await ns(),t){case"USER_SRP_AUTH":return qt(e);case"USER_PASSWORD_AUTH":return is(e);case"CUSTOM_WITHOUT_SRP":return os(e);case"CUSTOM_WITH_SRP":return ss(e);case"USER_AUTH":return rs(e);default:return qt(e)}}const ds=3*60*1e3;function ls(e){const t=Te.listen("auth-internal",async({payload:o})=>{switch(o.event){case"confirmSignUp":{const s=o.data;s!=null&&s.isSignUpComplete&&(Te.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),n=setTimeout(()=>{t(),clearTimeout(n),j()},ds)}const us=()=>async e=>{if(e.statusCode>=300){const t=await xn(e);if(oe(t),t.name===We.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const n=f.EmptySignUpPassword,{message:o,recoverySuggestion:s}=Yt[n];throw new v({name:n,message:o,recoverySuggestion:s})}throw new v({name:t.name,message:t.message})}return In(e)},ps=e=>Y(G,Z("SignUp"),us(),{...J,...e});async function ms(e){var st;const{username:t,password:n,options:o}=e,s=(st=U.getConfig().Auth)==null?void 0:st.Cognito,i=(s==null?void 0:s.signUpVerificationMethod)??"code",{clientMetadata:a,validationData:c,autoSignIn:r}=e.options??{};T(s),R(!!t,f.EmptySignUpUsername);const d=typeof r!="boolean"?r:void 0;d==null||d.authFlowType;const{userPoolId:l,userPoolClientId:u,userPoolEndpoint:p}=s,h=ps({endpointResolver:C({endpointOverride:p})}),g={Username:t,Password:void 0,UserAttributes:(o==null?void 0:o.userAttributes)&&rt(o==null?void 0:o.userAttributes),ClientMetadata:a,ValidationData:c&&rt(c),ClientId:u,UserContextData:M({username:t,userPoolId:l,userPoolClientId:u})};n&&(g.Password=n);const{UserSub:S,CodeDeliveryDetails:x,UserConfirmed:I,Session:A}=await h({region:N(l),userAgentValue:D(_.SignUp)},g);(d||r===!0)&&(z.dispatch({type:"START"}),z.dispatch({type:"SET_USERNAME",value:t}),z.dispatch({type:"SET_SESSION",value:A}));const W={destination:x==null?void 0:x.Destination,deliveryMedium:x==null?void 0:x.DeliveryMedium,attributeName:x==null?void 0:x.AttributeName},ot=!!I,ee=z.getState().active;if(ot)return ee?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:S}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:S};if(ee){if(i==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:W},userId:S};ls()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:W},userId:S}}const Es=e=>Y(G,Z("ForgotPassword"),Q(),{...J,...e});async function hs(e){var u,p;const{username:t}=e;R(!!t,f.EmptyResetPasswordUsername);const n=(u=U.getConfig().Auth)==null?void 0:u.Cognito;T(n);const{userPoolClientId:o,userPoolId:s,userPoolEndpoint:i}=n,a=(p=e.options)==null?void 0:p.clientMetadata,c=M({username:t,userPoolId:s,userPoolClientId:o}),l=(await Es({endpointResolver:C({endpointOverride:i})})({region:N(s),userAgentValue:D(_.ResetPassword)},{Username:t,ClientMetadata:a,ClientId:o,UserContextData:c})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:l==null?void 0:l.DeliveryMedium,destination:l==null?void 0:l.Destination,attributeName:l==null?void 0:l.AttributeName}}}}const gs=e=>Y(G,Z("ConfirmForgotPassword"),Q(),{...J,...e});async function fs(e){var u,p;const t=(u=U.getConfig().Auth)==null?void 0:u.Cognito;T(t);const{userPoolClientId:n,userPoolId:o,userPoolEndpoint:s}=t,{username:i,newPassword:a}=e;R(!!i,f.EmptyConfirmResetPasswordUsername),R(!!a,f.EmptyConfirmResetPasswordNewPassword);const c=e.confirmationCode;R(!!c,f.EmptyConfirmResetPasswordConfirmationCode);const r=(p=e.options)==null?void 0:p.clientMetadata,d=M({username:i,userPoolId:o,userPoolClientId:n});await gs({endpointResolver:C({endpointOverride:s})})({region:N(t.userPoolId),userAgentValue:D(_.ConfirmResetPassword)},{Username:i,ConfirmationCode:c,Password:a,ClientMetadata:r,ClientId:t.userPoolClientId,UserContextData:d})}const Ss=e=>Y(G,Z("ResendConfirmationCode"),Q(),{...J,...e});async function xs(e){var h,g;const{username:t}=e;R(!!t,f.EmptySignUpUsername);const n=(h=U.getConfig().Auth)==null?void 0:h.Cognito;T(n);const{userPoolClientId:o,userPoolId:s,userPoolEndpoint:i}=n,a=(g=e.options)==null?void 0:g.clientMetadata,c=M({username:t,userPoolId:s,userPoolClientId:o}),r=Ss({endpointResolver:C({endpointOverride:i})}),{CodeDeliveryDetails:d}=await r({region:N(n.userPoolId),userAgentValue:D(_.ResendSignUpCode)},{Username:t,ClientMetadata:a,ClientId:n.userPoolClientId,UserContextData:c}),{DeliveryMedium:l,AttributeName:u,Destination:p}={...d};return{destination:p,deliveryMedium:l,attributeName:u||void 0}}const Is=e=>Y(G,Z("ConfirmSignUp"),Q(),{...J,...e});async function ys(e){var p;const{username:t,confirmationCode:n,options:o}=e,s=(p=U.getConfig().Auth)==null?void 0:p.Cognito;T(s);const{userPoolId:i,userPoolClientId:a,userPoolEndpoint:c}=s,r=o==null?void 0:o.clientMetadata;R(!!t,f.EmptyConfirmSignUpUsername),R(!!n,f.EmptyConfirmSignUpCode);const d=M({username:t,userPoolId:i,userPoolClientId:a}),l=Is({endpointResolver:C({endpointOverride:c})}),{Session:u}=await l({region:N(s.userPoolId),userAgentValue:D(_.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:r,ForceAliasCreation:o==null?void 0:o.forceAliasCreation,ClientId:s.userPoolClientId,UserContextData:d});return new Promise((h,g)=>{try{const S={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},x=z.getState();if(!x.active||x.username!==t){h(S),j();return}z.dispatch({type:"SET_SESSION",value:u});const I=Te.listen("auth-internal",({payload:A})=>{switch(A.event){case"autoSignIn":h({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),I()}});Te.dispatch("auth-internal",{event:"confirmSignUp",data:S})}catch(S){g(S)}})}const Rs=async({username:e,password:t})=>{await cs({username:e,password:t})},Ps=async({username:e,password:t,firstName:n,lastName:o})=>{await ms({username:e,password:t,options:{userAttributes:{email:e,given_name:n,family_name:o}}})},Cs=async({username:e,confirmationCode:t})=>{await ys({username:e,confirmationCode:t})},ke=async({username:e})=>{await xs({username:e})},on=async({username:e})=>{await hs({username:e})},Ns=async({username:e,confirmationCode:t,newPassword:n})=>{await fs({username:e,confirmationCode:t,newPassword:n})},ws=P.object({code:P.string().min(1,{message:"Code is required!"}).min(6,{message:"Code must be at least 6 characters!"}),email:P.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"})});function Ws(){const e=Ee(),n=Wt().get("email"),o=zt(5),s={code:"",email:n||""},i=fe({resolver:ge(ws),defaultValues:s}),{watch:a,handleSubmit:c,formState:{isSubmitting:r}}=i,d=a(),l=c(async h=>{try{await Cs({username:h.email,confirmationCode:h.code}),e.push(O.auth.amplify.signIn)}catch(g){console.error(g)}}),u=_e.useCallback(async()=>{if(!o.isCounting)try{o.reset(),o.start(),await(ke==null?void 0:ke({username:d.email}))}catch(h){console.error(h)}},[o,d.email]),p=()=>m.jsxs(X,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[m.jsx(F.Text,{name:"email",label:"Email address",placeholder:"example@gmail.com",slotProps:{inputLabel:{shrink:!0}},disabled:!0}),m.jsx(F.Code,{name:"code"}),m.jsx(he,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:r,loadingIndicator:"Verify...",children:"Verify"})]});return m.jsxs(m.Fragment,{children:[m.jsx(xe,{icon:m.jsx(Rn,{}),title:"Please check your email!",description:`We've emailed a 6-digit confirmation code. 
Please enter the code in the box below to verify your email.`}),m.jsx(Se,{methods:i,onSubmit:l,children:p()}),m.jsx(Kt,{onResendCode:u,value:o.value,disabled:o.isCounting}),m.jsx($e,{href:O.auth.amplify.signIn})]})}const vs=P.object({email:P.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:P.string().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"})});function zs(){const e=Ee(),t=Ke(),{checkUserSession:n}=yn(),[o,s]=_e.useState(null),i={email:"",password:""},a=fe({resolver:ge(vs),defaultValues:i}),{handleSubmit:c,formState:{isSubmitting:r}}=a,d=c(async u=>{try{await Rs({username:u.email,password:u.password}),await(n==null?void 0:n()),e.refresh()}catch(p){console.error(p);const h=$t(p);s(h)}}),l=()=>m.jsxs(X,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[m.jsx(F.Text,{name:"email",label:"Email address",slotProps:{inputLabel:{shrink:!0}}}),m.jsxs(X,{sx:{gap:1.5,display:"flex",flexDirection:"column"},children:[m.jsx(He,{component:je,href:O.auth.amplify.resetPassword,variant:"body2",color:"inherit",sx:{alignSelf:"flex-end"},children:"Forgot password?"}),m.jsx(F.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:t.value?"text":"password",slotProps:{inputLabel:{shrink:!0},input:{endAdornment:m.jsx(Ae,{position:"end",children:m.jsx(Fe,{onClick:t.onToggle,edge:"end",children:m.jsx(Ue,{icon:t.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}})]}),m.jsx(he,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",loading:r,loadingIndicator:"Sign in...",children:"Sign in"})]});return m.jsxs(m.Fragment,{children:[m.jsx(xe,{title:"Sign in to your account",description:m.jsxs(m.Fragment,{children:["Don’t have an account? ",m.jsx(He,{component:je,href:O.auth.amplify.signUp,variant:"subtitle2",children:"Get started"})]}),sx:{textAlign:{xs:"center",md:"left"}}}),!!o&&m.jsx(Vt,{severity:"error",sx:{mb:3},children:o}),m.jsx(Se,{methods:a,onSubmit:d,children:l()})]})}const Ts=P.object({firstName:P.string().min(1,{message:"First name is required!"}),lastName:P.string().min(1,{message:"Last name is required!"}),email:P.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:P.string().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"})});function Vs(){const e=Ee(),t=Ke(),[n,o]=_e.useState(null),s={firstName:"",lastName:"",email:"",password:""},i=fe({resolver:ge(Ts),defaultValues:s}),{handleSubmit:a,formState:{isSubmitting:c}}=i,r=u=>{const p=new URLSearchParams({email:u}).toString();return`${O.auth.amplify.verify}?${p}`},d=a(async u=>{try{await Ps({username:u.email,password:u.password,firstName:u.firstName,lastName:u.lastName});const p=r(u.email);e.push(p)}catch(p){console.error(p);const h=$t(p);o(h)}}),l=()=>m.jsxs(X,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[m.jsxs(X,{sx:{display:"flex",gap:{xs:3,sm:2},flexDirection:{xs:"column",sm:"row"}},children:[m.jsx(F.Text,{name:"firstName",label:"First name",slotProps:{inputLabel:{shrink:!0}}}),m.jsx(F.Text,{name:"lastName",label:"Last name",slotProps:{inputLabel:{shrink:!0}}})]}),m.jsx(F.Text,{name:"email",label:"Email address",slotProps:{inputLabel:{shrink:!0}}}),m.jsx(F.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:t.value?"text":"password",slotProps:{inputLabel:{shrink:!0},input:{endAdornment:m.jsx(Ae,{position:"end",children:m.jsx(Fe,{onClick:t.onToggle,edge:"end",children:m.jsx(Ue,{icon:t.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}}),m.jsx(he,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",loading:c,loadingIndicator:"Create account...",children:"Create account"})]});return m.jsxs(m.Fragment,{children:[m.jsx(xe,{title:"Get started absolutely free",description:m.jsxs(m.Fragment,{children:["Already have an account? ",m.jsx(He,{component:je,href:O.auth.amplify.signIn,variant:"subtitle2",children:"Get started"})]}),sx:{textAlign:{xs:"center",md:"left"}}}),!!n&&m.jsx(Vt,{severity:"error",sx:{mb:3},children:n}),m.jsx(Se,{methods:i,onSubmit:d,children:l()}),m.jsx(Nn,{})]})}const As=P.object({email:P.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"})});function Ks(){const e=Ee(),t={email:""},n=fe({resolver:ge(As),defaultValues:t}),{handleSubmit:o,formState:{isSubmitting:s}}=n,i=r=>{const d=new URLSearchParams({email:r}).toString();return`${O.auth.amplify.updatePassword}?${d}`},a=o(async r=>{try{await on({username:r.email});const d=i(r.email);e.push(d)}catch(d){console.error(d)}}),c=()=>m.jsxs(X,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[m.jsx(F.Text,{autoFocus:!0,name:"email",label:"Email address",placeholder:"example@gmail.com",slotProps:{inputLabel:{shrink:!0}}}),m.jsx(he,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:s,loadingIndicator:"Send request...",children:"Send request"})]});return m.jsxs(m.Fragment,{children:[m.jsx(xe,{icon:m.jsx(Pn,{}),title:"Forgot your password?",description:"Please enter the email address associated with your account and we'll email you a link to reset your password."}),m.jsx(Se,{methods:n,onSubmit:a,children:c()}),m.jsx($e,{href:O.auth.amplify.signIn})]})}const Fs=P.object({code:P.string().min(1,{message:"Code is required!"}).min(6,{message:"Code must be at least 6 characters!"}),email:P.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:P.string().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"}),confirmPassword:P.string().min(1,{message:"Confirm password is required!"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match!",path:["confirmPassword"]});function $s(){const e=Ee(),n=Wt().get("email"),o=Ke(),s=zt(5),i={code:"",email:n||"",password:"",confirmPassword:""},a=fe({resolver:ge(Fs),defaultValues:i}),{watch:c,handleSubmit:r,formState:{isSubmitting:d}}=a,l=c(),u=r(async g=>{try{await Ns({username:g.email,confirmationCode:g.code,newPassword:g.password}),e.push(O.auth.amplify.signIn)}catch(S){console.error(S)}}),p=_e.useCallback(async()=>{if(!s.isCounting)try{s.reset(),s.start(),await on({username:l.email})}catch(g){console.error(g)}},[s,l.email]),h=()=>m.jsxs(X,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[m.jsx(F.Text,{name:"email",label:"Email address",placeholder:"example@gmail.com",slotProps:{inputLabel:{shrink:!0}},disabled:!0}),m.jsx(F.Code,{name:"code"}),m.jsx(F.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:o.value?"text":"password",slotProps:{inputLabel:{shrink:!0},input:{endAdornment:m.jsx(Ae,{position:"end",children:m.jsx(Fe,{onClick:o.onToggle,edge:"end",children:m.jsx(Ue,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}}),m.jsx(F.Text,{name:"confirmPassword",label:"Confirm new password",type:o.value?"text":"password",slotProps:{inputLabel:{shrink:!0},input:{endAdornment:m.jsx(Ae,{position:"end",children:m.jsx(Fe,{onClick:o.onToggle,edge:"end",children:m.jsx(Ue,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}}),m.jsx(he,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:d,loadingIndicator:"Update password...",children:"Update password"})]});return m.jsxs(m.Fragment,{children:[m.jsx(xe,{icon:m.jsx(Cn,{}),title:"Request sent successfully!",description:`We've sent a 6-digit confirmation email to your email. 
Please enter the code in below box to verify your email.`}),m.jsx(Se,{methods:a,onSubmit:u,children:h()}),m.jsx(Kt,{onResendCode:p,value:s.value,disabled:s.isCounting}),m.jsx($e,{href:O.auth.amplify.signIn})]})}export{zs as A,Vs as a,Ws as b,$s as c,Ks as d};
