import{cq as M,j as e,t as Z,dQ as V,ct as _,cu as R,R as F,I as j,B as g,cv as ee,ex as se,N as H,fh as q,V as G,g as d,O as S,F as W,H as te,dR as ne,dS as re,bA as $,bB as ae,bD as J,bE as ie,bF as oe,A as E,T as C,b1 as K,dT as le,U as ce,bG as de,fW as Q,bK as N,b4 as xe,dZ as he,dP as pe,D as me,cy as D,K as ue,dU as fe,fj as ge,eh as be,dJ as je,fl as ve,fT as ye,fX as Ce,fY as Se,o as ke}from"./index-BPi-lj99.js";import{E as De}from"./empty-content-9ilj_6E5.js";import{d as U}from"./format-number-bPxp5Hz3.js";import{I as L}from"./image-31DAP9Wr.js";import{P as Fe,p as Te}from"./Pagination-p1dEkr85.js";import{C as we}from"./fields-C_OA-jBI.js";import{S as X}from"./Stack-qxGgU9sa.js";import{J as z}from"./DatePicker-CUx5CUAj.js";import{F as Ie}from"./FormControlLabel-CR_hDGs6.js";import{C as Re}from"./Checkbox-Cb0hcSDN.js";import{F as Ee,a as w,c as I}from"./filters-result-uhHU2u14.js";import{o as B}from"./orderBy-BP_idRMj.js";import"./tour-new-edit-form-C-Ltnd-6.js";import"./html-to-markdown-BekkAF-z.js";import"./LastPage-ClWw7PMw.js";import"./styles-BkVqaM-o.js";import"./Rating-Bkwu4u_e.js";import"./editor-BHaBjMrK.js";import"./code-highlight-block-CqLMdGe8.js";import"./FormGroup-CwCuTxF6.js";import"./index-BSK_tT2J.js";import"./index-Chjiymov.js";import"./upload-BlD-M9M6.js";import"./index-DpGkvVRP.js";import"./preview-single-file-CNraPjvt.js";import"./DialogActions-D-kuG3ww.js";import"./DialogContent-31eqGF97.js";import"./dialogTitleClasses-pRzgyf3x.js";import"./zod-B_WTTuJ9.js";import"./schema-helper-zXJyfLbR.js";import"./form-provider-BxIa1T6o.js";function Pe({tour:s,editHref:p,detailsHref:a,onDelete:n,sx:r,...x}){const c=M(),o=()=>e.jsxs(g,{sx:{top:8,right:8,zIndex:9,display:"flex",borderRadius:1,alignItems:"center",position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(j,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",s.ratingNumber]}),h=()=>e.jsxs(g,{sx:{top:8,left:8,zIndex:9,display:"flex",borderRadius:1,bgcolor:"grey.800",alignItems:"center",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!s.priceSale&&e.jsx(g,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:U(s.priceSale)}),U(s.price)]}),m=()=>e.jsxs(g,{sx:{p:1,gap:.5,display:"flex"},children:[e.jsxs(g,{sx:{flexGrow:1,position:"relative"},children:[h(),o(),e.jsx(L,{alt:s.images[0],src:s.images[0],sx:{width:1,height:164,borderRadius:1}})]}),e.jsxs(g,{sx:{gap:.5,display:"flex",flexDirection:"column"},children:[e.jsx(L,{alt:s.images[1],src:s.images[1],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}}),e.jsx(L,{alt:s.images[2],src:s.images[2],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}})]})]}),t=()=>e.jsx(ee,{sx:[i=>({p:i.spacing(2.5,2.5,2,2.5)})],primary:`Posted date: ${se(s.createdAt)}`,secondary:e.jsx(H,{component:F,href:a,color:"inherit",children:s.name}),slotProps:{primary:{sx:{typography:"caption",color:"text.disabled"}},secondary:{noWrap:!0,component:"h6",sx:{mt:1,color:"text.primary",typography:"subtitle1"}}}}),u=()=>e.jsxs(g,{sx:[i=>({gap:1.5,display:"flex",position:"relative",flexDirection:"column",p:i.spacing(0,2.5,2.5,2.5)})],children:[e.jsx(G,{onClick:c.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(j,{icon:"eva:more-vertical-fill"})}),[{icon:e.jsx(j,{icon:"mingcute:location-fill",sx:{color:"error.main"}}),label:s.destination},{icon:e.jsx(j,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}}),label:q(s.available.startDate,s.available.endDate)},{icon:e.jsx(j,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}}),label:`${s.bookers.length} Booked`}].map(i=>e.jsxs(g,{sx:[{gap:.5,display:"flex",typography:"body2",alignItems:"center"}],children:[i.icon,i.label]},i.label))]}),f=()=>e.jsx(V,{open:c.open,anchorEl:c.anchorEl,onClose:c.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(_,{children:[e.jsx("li",{children:e.jsxs(R,{component:F,href:a,onClick:()=>c.onClose(),children:[e.jsx(j,{icon:"solar:eye-bold"}),"View"]})}),e.jsx("li",{children:e.jsxs(R,{component:F,href:p,onClick:()=>c.onClose(),children:[e.jsx(j,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsxs(R,{onClick:()=>{c.onClose(),n()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{sx:r,...x,children:[m(),t(),u()]}),f()]})}function Oe({tours:s}){const p=d.useCallback(a=>{console.info("DELETE",a)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:s.map(a=>e.jsx(Pe,{tour:a,editHref:S.dashboard.tour.edit(a.id),detailsHref:S.dashboard.tour.details(a.id),onDelete:()=>p(a.id)},a.id))}),s.length>8&&e.jsx(Fe,{count:8,sx:{mt:{xs:5,md:8},[`& .${Te.ul}`]:{justifyContent:"center"}}})]})}function Ae({sort:s,onSort:p,sortOptions:a}){const n=M(),r=()=>e.jsx(V,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,children:e.jsx(_,{children:a.map(x=>e.jsx(R,{selected:x.value===s,onClick:()=>{n.onClose(),p(x.value)},children:x.label},x.value))})});return e.jsxs(e.Fragment,{children:[e.jsxs(W,{disableRipple:!0,color:"inherit",onClick:n.onOpen,endIcon:e.jsx(j,{icon:n.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(g,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),r()]})}function Le({redirectPath:s,sx:p}){const a=te(),[n,r]=d.useState(""),[x,c]=d.useState(null),o=ne(n),{searchResults:h,searchLoading:m}=Be(o),t=d.useCallback(i=>{c(i),i&&a.push(s(i.id))},[a,s]),u=re({matchFrom:"any",stringify:i=>`${i.name} ${i.destination}`}),f={width:320,[`& .${$.listbox}`]:{[`& .${$.option}`]:{p:0,[`& .${ae.root}`]:{p:.75,gap:1.5,width:1,display:"flex",alignItems:"center"}}}};return e.jsx(J,{autoHighlight:!0,popupIcon:null,loading:m,options:h,value:x,filterOptions:u,onChange:(i,b)=>t(b),onInputChange:(i,b)=>r(b),getOptionLabel:i=>i.name,noOptionsText:e.jsx(de,{query:o}),isOptionEqualToValue:(i,b)=>i.id===b.id,slotProps:{paper:{sx:f}},sx:[{width:{xs:1,sm:260}},...Array.isArray(p)?p:[p]],renderInput:i=>e.jsx(K,{...i,placeholder:"Search...",slotProps:{input:{...i.InputProps,startAdornment:e.jsx(ce,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})}),endAdornment:e.jsxs(e.Fragment,{children:[m?e.jsx(le,{size:18,color:"inherit",sx:{mr:-3}}):null,i.InputProps.endAdornment]})}}}),renderOption:(i,b,{inputValue:T})=>{const P=ie(b.name,T),O=oe(b.name,P);return d.createElement("li",{...i,key:b.id},e.jsxs(H,{component:F,href:s(b.id),color:"inherit",underline:"none",children:[e.jsx(E,{alt:b.name,src:b.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,borderRadius:1}},b.id),e.jsx("div",{children:O.map((k,A)=>e.jsx(C,{component:"span",color:k.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:k.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:k.text},A))},T)]}))}})}function Be(s){const[p,a]=d.useState([]),[n,r]=d.useState(!1),x=d.useCallback(async()=>{r(!0);try{await new Promise(o=>setTimeout(o,500));const c=Q.filter(({name:o,destination:h})=>[o,h].some(m=>m==null?void 0:m.toLowerCase().includes(s.toLowerCase())));a(c)}catch(c){console.error(c)}finally{r(!1)}},[s]);return d.useEffect(()=>{s?x():a([])},[x,s]),{searchResults:p,searchLoading:n}}function Ge({open:s,onOpen:p,onClose:a,filters:n,options:r,canReset:x,dateError:c}){const{state:o,setState:h,resetState:m}=n,t=d.useCallback(l=>{const v=o.services.includes(l)?o.services.filter(y=>y!==l):[...o.services,l];h({services:v})},[h,o.services]),u=d.useCallback(l=>{h({startDate:l})},[h]),f=d.useCallback(l=>{h({endDate:l})},[h]),i=d.useCallback(l=>{h({destination:l})},[h]),b=d.useCallback(l=>{h({tourGuides:l})},[h]),T=()=>e.jsxs(e.Fragment,{children:[e.jsxs(g,{sx:{py:2,pr:1,pl:2.5,display:"flex",alignItems:"center"},children:[e.jsx(C,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(pe,{title:"Reset",children:e.jsx(G,{onClick:()=>m(),children:e.jsx(N,{color:"error",variant:"dot",invisible:!x,children:e.jsx(j,{icon:"solar:restart-bold"})})})}),e.jsx(G,{onClick:a,children:e.jsx(j,{icon:"mingcute:close-line"})})]}),e.jsx(me,{sx:{borderStyle:"dashed"}})]}),P=()=>e.jsxs(g,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsx(z,{label:"Start date",value:o.startDate,onChange:u,sx:{mb:2.5}}),e.jsx(z,{label:"End date",value:o.endDate,onChange:f,slotProps:{textField:{error:c,helperText:c?"End date must be later than start date":null}}})]}),O=()=>e.jsxs(g,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(we,{id:"multiple-destinations",multiple:!0,fullWidth:!0,placeholder:o.destination.length?"+ Destination":"Select Destination",value:o.destination,onChange:(l,v)=>i(v)})]}),k=()=>e.jsxs(g,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(J,{multiple:!0,disableCloseOnSelect:!0,options:r.tourGuides,value:o.tourGuides,onChange:(l,v)=>b(v),getOptionLabel:l=>l.name,renderInput:l=>e.jsx(K,{placeholder:"Select Tour Guides",...l}),renderOption:(l,v)=>d.createElement("li",{...l,key:v.id},e.jsx(E,{alt:v.avatarUrl,src:v.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},v.id),v.name),renderTags:(l,v)=>l.map((y,Y)=>d.createElement(D,{...v({index:Y}),key:y.id,size:"small",variant:"soft",label:y.name,avatar:e.jsx(E,{alt:y.name,src:y.avatarUrl})}))})]}),A=()=>e.jsxs(g,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Services"}),r.services.map(l=>e.jsx(Ie,{label:l,control:e.jsx(Re,{checked:o.services.includes(l),onClick:()=>t(l),slotProps:{input:{id:`${l}-checkbox`}}})},l))]});return e.jsxs(e.Fragment,{children:[e.jsx(W,{disableRipple:!0,color:"inherit",endIcon:e.jsx(N,{color:"error",variant:"dot",invisible:!x,children:e.jsx(j,{icon:"ic:round-filter-list"})}),onClick:p,children:"Filters"}),e.jsxs(xe,{anchor:"right",open:s,onClose:a,slotProps:{backdrop:{invisible:!0},paper:{sx:{width:320}}},children:[T(),e.jsx(he,{sx:{px:2.5,py:3},children:e.jsxs(X,{spacing:3,children:[P(),O(),k(),A()]})})]})]})}function We({filters:s,totalResults:p,sx:a}){const{state:n,setState:r,resetState:x}=s,c=d.useCallback(t=>{const u=n.services.filter(f=>f!==t);r({services:u})},[r,n.services]),o=d.useCallback(()=>{r({startDate:null,endDate:null})},[r]),h=d.useCallback(t=>{const u=n.tourGuides.filter(f=>f.name!==t.name);r({tourGuides:u})},[r,n.tourGuides]),m=d.useCallback(t=>{const u=n.destination.filter(f=>f!==t);r({destination:u})},[r,n.destination]);return e.jsxs(Ee,{totalResults:p,onReset:()=>x(),sx:a,children:[e.jsx(w,{label:"Available:",isShow:!!(n.startDate&&n.endDate),children:e.jsx(D,{...I,label:q(n.startDate,n.endDate),onDelete:o})}),e.jsx(w,{label:"Services:",isShow:!!n.services.length,children:n.services.map(t=>d.createElement(D,{...I,key:t,label:t,onDelete:()=>c(t)}))}),e.jsx(w,{label:"Tour guide:",isShow:!!n.tourGuides.length,children:n.tourGuides.map(t=>d.createElement(D,{...I,key:t.id,avatar:e.jsx(E,{alt:t.name,src:t.avatarUrl}),label:t.name,onDelete:()=>h(t)}))}),e.jsx(w,{label:"Destination:",isShow:!!n.destination.length,children:n.destination.map(t=>d.createElement(D,{...I,key:t,label:t,onDelete:()=>m(t)}))})]})}function $e(){const s=ue(),[p,a]=d.useState("latest"),n=fe({destination:[],tourGuides:[],services:[],startDate:null,endDate:null}),{state:r}=n,x=ge(r.startDate,r.endDate),c=Ne({inputData:Q,filters:r,sortBy:p,dateError:x}),o=r.destination.length>0||r.tourGuides.length>0||r.services.length>0||!!r.startDate&&!!r.endDate,h=!c.length&&o,m=d.useCallback(f=>{a(f)},[]),t=()=>e.jsxs(g,{sx:{gap:3,display:"flex",justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(Le,{redirectPath:f=>S.dashboard.tour.details(f)}),e.jsxs(g,{sx:{gap:1,flexShrink:0,display:"flex"},children:[e.jsx(Ge,{filters:n,canReset:o,dateError:x,open:s.value,onOpen:s.onTrue,onClose:s.onFalse,options:{tourGuides:Ce,services:ye.map(f=>f.label)}}),e.jsx(Ae,{sort:p,onSort:m,sortOptions:Se})]})]}),u=()=>e.jsx(We,{filters:n,totalResults:c.length});return e.jsxs(be,{children:[e.jsx(je,{heading:"List",links:[{name:"Dashboard",href:S.dashboard.root},{name:"Tour",href:S.dashboard.tour.root},{name:"List"}],action:e.jsx(W,{component:F,href:S.dashboard.tour.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(X,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[t(),o&&u()]}),h&&e.jsx(De,{filled:!0,sx:{py:10}}),e.jsx(Oe,{tours:c})]})}function Ne({inputData:s,filters:p,sortBy:a,dateError:n}){const{services:r,destination:x,startDate:c,endDate:o,tourGuides:h}=p,m=h.map(t=>t.id);return a==="latest"&&(s=B(s,["createdAt"],["desc"])),a==="oldest"&&(s=B(s,["createdAt"],["asc"])),a==="popular"&&(s=B(s,["totalViews"],["desc"])),x.length&&(s=s.filter(t=>x.includes(t.destination))),m.length&&(s=s.filter(t=>t.tourGuides.some(u=>m.includes(u.id)))),r.length&&(s=s.filter(t=>t.services.some(u=>r.includes(u)))),n||c&&o&&(s=s.filter(t=>ve(c,t.available.startDate,t.available.endDate))),s}const Ue={title:`Tour list | Dashboard - ${ke.appName}`};function js(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Ue.title}),e.jsx($e,{})]})}export{js as default};
