import{N as z,O as b,dX as V,W as B,g as d,j as e,fj as M,z as v,bI as f,aU as D,D as C,T as l,fX as L,cy as S,A as T,B as y,fT as W,dY as _,cz as H,M as X,Z as Y,I as Z}from"./index-usks_mw-.js";import{s as J,z as t}from"./zod-RlOVw4MX.js";import{u as K}from"./styles-CfUPITlh.js";import{F as n}from"./fields-C0p86-nh.js";import"./preview-single-file-BDCIPO5I.js";import"./code-highlight-block-BPaUgu3R.js";import{s as m}from"./schema-helper-nSaw4j_a.js";import{F as Q}from"./form-provider-BBryKxXX.js";import{S as i}from"./Stack-CgODRvvD.js";import{F as $}from"./FormControlLabel-4BKoF0oU.js";const G=t.object({name:t.string().min(1,{message:"Name is required!"}),content:m.editor().min(100,{message:"Content must be at least 100 characters"}).max(500,{message:"Content must be less than 500 characters"}),images:m.files({message:"Images is required!"}),tourGuides:t.array(t.object({id:t.string(),name:t.string(),avatarUrl:t.string(),phoneNumber:t.string()})).min(1,{message:"Must have at least 1 guide!"}),available:t.object({startDate:m.date({message:{required:"Start date is required!"}}),endDate:m.date({message:{required:"End date is required!"}})}),durations:t.string().min(1,{message:"Durations is required!"}),destination:m.nullableInput(t.string().min(1,{message:"Destination is required!"}),{message:"Destination is required!"}),services:t.string().array().min(2,{message:"Must have at least 2 items!"}),tags:t.string().array().min(2,{message:"Must have at least 2 items!"})}).refine(o=>!M(o.available.startDate,o.available.endDate),{message:"End date cannot be earlier than start date!",path:["available.endDate"]});function ce({currentTour:o}){const E=z(),x=b(!0),p=b(!0),w={name:"",content:"",images:[],tourGuides:[],available:{startDate:null,endDate:null},durations:"",destination:"",services:[],tags:[]},g=K({mode:"all",resolver:J(G),defaultValues:w,values:o}),{watch:k,reset:A,setValue:u,handleSubmit:O,formState:{isSubmitting:I}}=g,h=k(),q=O(async a=>{try{await new Promise(s=>setTimeout(s,500)),A(),V.success(o?"Update success!":"Create success!"),E.push(B.dashboard.tour.root),console.info("DATA",a)}catch(s){console.error(s)}}),F=d.useCallback(a=>{var r;const s=h.images&&((r=h.images)==null?void 0:r.filter(c=>c!==a));u("images",s,{shouldValidate:!0})},[u,h.images]),P=d.useCallback(()=>{u("images",[],{shouldValidate:!0})},[u]),j=(a,s)=>e.jsx(Y,{onClick:s,children:e.jsx(Z,{icon:a?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})}),U=()=>e.jsxs(v,{children:[e.jsx(f,{title:"Details",subheader:"Title, short description, image...",action:j(x.value,x.onToggle),sx:{mb:3}}),e.jsxs(D,{in:x.value,children:[e.jsx(C,{}),e.jsxs(i,{spacing:3,sx:{p:3},children:[e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Name"}),e.jsx(n.Text,{name:"name",placeholder:"Ex: Adventure Seekers Expedition..."})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Content"}),e.jsx(n.Editor,{name:"content",sx:{maxHeight:480}})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Images"}),e.jsx(n.Upload,{multiple:!0,thumbnail:!0,name:"images",maxSize:3145728,onRemove:F,onRemoveAll:P,onUpload:()=>console.info("ON UPLOAD")})]})]})]})]}),N=()=>e.jsxs(v,{children:[e.jsx(f,{title:"Properties",subheader:"Additional functions and attributes...",action:j(p.value,p.onToggle),sx:{mb:3}}),e.jsxs(D,{in:p.value,children:[e.jsx(C,{}),e.jsxs(i,{spacing:3,sx:{p:3},children:[e.jsxs("div",{children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(n.Autocomplete,{multiple:!0,name:"tourGuides",placeholder:"+ Tour Guides",disableCloseOnSelect:!0,options:L,getOptionLabel:a=>a.name,isOptionEqualToValue:(a,s)=>a.id===s.id,renderOption:(a,s)=>d.createElement("li",{...a,key:s.id},e.jsx(T,{alt:s.avatarUrl,src:s.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},s.id),s.name),renderTags:(a,s)=>a.map((r,c)=>d.createElement(S,{...s({index:c}),key:r.id,size:"small",variant:"soft",label:r.name,avatar:e.jsx(T,{alt:r.name,src:r.avatarUrl})}))})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Available"}),e.jsxs(y,{sx:{gap:2,display:"flex",flexDirection:{xs:"column",md:"row"}},children:[e.jsx(n.DatePicker,{name:"available.startDate",label:"Start date"}),e.jsx(n.DatePicker,{name:"available.endDate",label:"End date"})]})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Duration"}),e.jsx(n.Text,{name:"durations",placeholder:"Ex: 2 days, 4 days 3 nights..."})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Destination"}),e.jsx(n.CountrySelect,{fullWidth:!0,name:"destination",placeholder:"+ Destination"})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{variant:"subtitle2",children:"Services"}),e.jsx(n.MultiCheckbox,{name:"services",options:W,sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Tags"}),e.jsx(n.Autocomplete,{name:"tags",placeholder:"+ Tags",multiple:!0,freeSolo:!0,disableCloseOnSelect:!0,options:_.map(a=>a),getOptionLabel:a=>a,renderOption:(a,s)=>d.createElement("li",{...a,key:s},s),renderTags:(a,s)=>a.map((r,c)=>d.createElement(S,{...s({index:c}),key:r,label:r,size:"small",color:"info",variant:"soft"}))})]})]})]})]}),R=()=>e.jsxs(y,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[e.jsx($,{label:"Publish",control:e.jsx(H,{defaultChecked:!0,slotProps:{input:{id:"publish-switch"}}}),sx:{flexGrow:1,pl:3}}),e.jsx(X,{type:"submit",variant:"contained",size:"large",loading:I,sx:{ml:2},children:o?"Save changes":"Create tour"})]});return e.jsx(Q,{methods:g,onSubmit:q,children:e.jsxs(i,{spacing:{xs:3,md:5},sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[U(),N(),R()]})})}export{ce as T};
